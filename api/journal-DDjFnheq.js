import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as n}from"./cache-CvppK6AM.js";import{art as r}from"./render-DE4LRFBD.js";import{got_default as i}from"./got-BwctkUCD.js";import a from"node:path";import{load as o}from"cheerio";import{CookieJar as s}from"tough-cookie";t();const c=new s,l={path:[`/:journal/latest`,`/:journal`],radar:[{source:[`www.sciencedirect.com/journal/:journal/*`],target:`/:journal`}],name:`Unknown`,maintainers:[],handler:u};async function u(t){let s=t.req.param(`journal`),l=`https://www.sciencedirect.com`,u=`${l}/journal/${s}`,d=await i(u,{cookieJar:c}),f=o(d.data),p=f(`.anchor.js-title-link`).text(),m=`${l}${f(`.link-anchor.u-clr-black`).attr(`href`)}`,h=``;m.match(`suppl`)===null?m.match(`issue`)!==null&&(h=`Volume `+m.match(`vol/(.*)/issue`)[1]+` Issue `+m.match(`/issue/(.*)`)[1]):h=`Volume `+m.match(`vol/(.*)/suppl`)[1];let g=await i(m,{cookieJar:c}),_=o(g.data),v=_(`.js-article`).map((e,t)=>{let n=_(t).find(`.js-article-title`).text(),r=_(t).find(`.js-article__item__authors`).text(),i=_(t).find(`.article-content-title`).attr(`href`),a=_(t).find(`.article-content-title`).attr(`id`);return{title:n,link:i,id:a,authors:r,issue:h}}).get(),y=t=>r(a.join(e,`templates/description-cc75687b.art`),{item:t}),b=await Promise.all(v.map(e=>n.tryGet(e.link,async()=>{let t=await i(`${l}/science/article/pii/${e.id}`,{cookieJar:c}),n=o(t.data);return n(`.section-title`).remove(),e.doi=n(`.doi`).attr(`href`).replace(`https://doi.org/`,``),e.abstract=n(`.abstract.author`).text(),e.description=y(e),e})));return{title:p,link:u,item:b}}export{l as route};