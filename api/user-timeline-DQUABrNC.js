import"./esm-shims-CtP6w_ML.js";import{config as e}from"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CDAeBYLA.js";import"./helpers-RrXnNmv1.js";import"./cache-7MGQxbL-.js";import"./render-DlHIMz-Z.js";import"./parse-date-B2cCVoGk.js";import"./got-Cw4D6IS5.js";import{invalid_parameter_default as t}from"./invalid-parameter-0LlYSQjk.js";import{ViewType as n}from"./types-DygLf1a3.js";import{fallback as r,queryToBoolean as i}from"./readable-social-Dld9apEb.js";import{config_not_found_default as a}from"./config-not-found-DTjmIGAO.js";import{utils_default$5 as o}from"./utils-BHroYbic.js";import s from"querystring";const c={path:`/users/notes/:username/:routeParams?`,categories:[`social-media`,`popular`],view:n.SocialMedia,example:`/misskey/users/notes/support@misskey.io`,parameters:{username:`Misskey username in the format of username@instance.domain`,routeParams:`
| Key               | Description                             | Accepted Values | Default |
| ----------------- | --------------------------------------- | --------------- | ------- |
| withRenotes       | Include renotes in the timeline         | 0/1/true/false  | false   |
| mediaOnly         | Only return posts containing media      | 0/1/true/false  | false   |
| simplifyAuthor    | Simplify author field in feed items     | 0/1/true/false  | false   |

Note: \`withRenotes\` and \`mediaOnly\` are mutually exclusive and cannot both be set to true.

Examples:
- /misskey/users/notes/mttb2ccp@misskey.io/withRenotes=true
- /misskey/users/notes/mttb2ccp@misskey.io/mediaOnly=true`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`User timeline`,maintainers:[`siygle`,`SnowAgar25`,`HanaokaYuzu`],handler:l};async function l(n){let c=n.req.param(`username`),[,l,u]=c.match(/@?(\w+)@(\w+\.\w+)/)||[];if(!l||!u)throw new t(`Provide a valid Misskey username`);if(!e.feature.allow_user_supply_unsafe_domain&&!o.allowSiteList.includes(u))throw new a(`This RSS is disabled unless 'ALLOW_USER_SUPPLY_UNSAFE_DOMAIN' is set to 'true'.`);let d=s.parse(n.req.param(`routeParams`)),f=r(void 0,i(d.withRenotes),!1),p=r(void 0,i(d.mediaOnly),!1),m=r(void 0,i(d.simplifyAuthor),!1);if(f&&p)throw new t(`withRenotes and mediaOnly cannot both be true.`);let{accountData:h,avatarUrl:g}=await o.getUserTimelineByUsername(l,u,{withRenotes:f,mediaOnly:p});return{title:`User timeline for ${c} on ${u}`,link:`https://${u}/@${l}`,image:g??``,item:o.parseNotes(h,u,m)}}export{c as route};