import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import{cache_default as n}from"./cache-CvppK6AM.js";import{art as r}from"./render-DE4LRFBD.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-BwctkUCD.js";import o from"node:path";import{load as s}from"cheerio";t();const c=e=>({title:e.name,link:e.link,description:e.name,pubDate:i(e.pubTimeLong),media:{content:{url:e.pic}}});var l={ProcessItem:(t,l)=>{let u=l.req.query(`old`)===`yes`;if(t.link)return c(t);let d=`https://m.thepaper.cn/detail/${t.contId}`;return n.tryGet(`${d}${u?`:old`:``}`,async()=>{let n=await a(d),l=JSON.parse(s(n.data)(`#__NEXT_DATA__`).html()),f=l.props.pageProps.detailData,p=f.contentDetail||f.liveDetail||f.specialDetail?.specialInfo;if(!p)return c(t);let m=p.content||p.summary||p.desc||``;p.videos&&(m+=p.summary),u&&(p.videos&&(m=r(o.join(e,`templates/video_detail-6e02b70e.art`),{videos:p.videos})+m),p.images&&(m=r(o.join(e,`templates/image_detail-7a807b2d.art`),{images:p.images})+m));let h={title:p.name||p.shareName,link:d,description:m,category:[...p.tagList?.map(e=>e.tag)??[],p?.nodeInfo?.name??[]],pubDate:i(t.pubTimeLong||p.pubTime||p.publishTime),author:p.author||``,media:{content:{url:t.pic||p.videos?.coverUrl||p.bigPic},thumbnails:{url:t.sharePic||p.sharePic}}};return p.voiceInfo?.isHaveVoice&&(h.enclosure_type=`audio/mpeg`,h.enclosure_url=p.voiceInfo.voiceSrc,h.itunes_item_image=t.pic||p.videos?.coverUrl),h})},ChannelIdToName:(e,t)=>t.props.appProps.menu.channelList.find(t=>t.nodeId.toString()===e.toString()).name,ListIdToName:(e,t)=>t.props.appProps.menu.channelList.flatMap(e=>e.childNodeList||[]).find(t=>t.nodeId.toString()===e.toString())?.name,ExtractLogo:e=>`https://m.thepaper.cn`+s(e.data)(`img.imageCover`).attr(`src`)};export{l as utils_default$23};