import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{parseDate as e}from"./parse-date-DHsdom8D.js";import{got_default as t}from"./got-BwctkUCD.js";import{ViewType as n}from"./types-Bi82qguM.js";import{invalid_parameter_default as r}from"./invalid-parameter-CvwVNf6G.js";const i=`kimne78kx3ncx6brgo4mv6wki5h1ko`,a={archive:`LATEST_BROADCASTS`,highlights:`LATEST_NON_BROADCASTS`,all:`ALL_VIDEOS`},o={path:`/video/:login/:filter?`,categories:[`live`,`popular`],view:n.Videos,example:`/twitch/video/riotgames/highlights`,parameters:{login:`Twitch username`,filter:{description:`Video type, Default to all`,options:[{value:`archive`,label:`Archive`},{value:`highlights`,label:`Highlights`},{value:`all`,label:`All`}],default:`all`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.twitch.tv/:login/videos`],target:`/video/:login`}],name:`Channel Video`,maintainers:[`hoilc`],handler:s};async function s(n){let o=n.req.param(`login`),s=n.req.param(`filter`)?.toLowerCase()||`all`;if(!a[s])throw new r(`Unsupported filter type "${s}", please choose from { ${Object.keys(a).join(`, `)} }`);let c=await t({method:`post`,url:`https://gql.twitch.tv/gql`,headers:{Referer:`https://player.twitch.tv`,"Client-ID":i},json:[{operationName:`ChannelVideoShelvesQuery`,variables:{channelLogin:o,first:5},extensions:{persistedQuery:{version:1,sha256Hash:`7b31d8ae7274b79d169a504e3727baaaed0d5ede101f4a38fc44f34d76827903`}}}]}),l=c.data[0].data;if(!l.user.id)throw new r(`Username does not exist`);let u=l.user.displayName,d=l.user.videoShelves.edges.find(e=>e.node.type===a[s]);if(!d)throw new r(`No video under filter type "${s}"`);let f=d.node.items.map(t=>({title:t.title,link:`https://www.twitch.tv/videos/${t.id}`,author:u,pubDate:e(t.publishedAt),description:`<img style="max-width: 100%;" src="${t.previewThumbnailURL}"><br/><img style="max-width: 100%;" src="${t.animatedPreviewURL}">`,category:t.game&&[t.game.displayName]}));return{title:`Twitch - ${u} - ${d.node.title}`,link:`https://www.twitch.tv/${o}`,item:f}}export{o as route};