import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as n}from"./cache-CvppK6AM.js";import{art as r}from"./render-DE4LRFBD.js";import{got_default as i}from"./got-BwctkUCD.js";import a from"node:path";import{load as o}from"cheerio";t();const s=({subtitle:t,quotation:n,pics:i,article:o})=>r(a.join(e,`templates/description-3b70807f.art`),{subtitle:t,quotation:n,pics:i,article:o}),c=async e=>{let t=await i({method:`get`,url:e}),n=o(t.data),r=n(`.right1 .bmname`).children().length;return{pageLength:r,$:n}},l=(e,t)=>{let n=e(`.zi .zi-top .banci strong`).text(),r=e(`.zi-meat ul>li`).map((r,i)=>{let a=e(i).find(`a`).attr(`href`),o=e(i).find(`a div`).text();return{link:`${t}/${a}`,title:`[${n}] ${o}`}}).get();return r},u=(e,t=1)=>{let n=async()=>{let n=`${e}/node_${t+1}.htm`,r=await i({method:`get`,url:n}),a=o(r.data);return l(a,e)};return n},d=async(e,t)=>{let n=await Promise.all(e.map(e=>t.tryGet(e.link,async()=>{let{data:t}=await i(e.link),n=o(t),r=n(`.right-meat .yinti`).text(),a=n(`.right-meat .futi`).text(),c=n(`.right-meat .tuwen .article #ozoom`).html(),l=n(`.right-meat .tuwen .picture`).map((e,t)=>{let r={};return n(t).find(`tr`).map((e,t)=>{let i=n(t).find(`img`).attr(`src`);return i?r.src=i:r.des=n(t).find(`td`).text(),null}).get(),r}).get();return e.author=n(`.right-meat .author`).text(),e.description=s({subtitle:a,quotation:r,article:c,pics:l}),e})));return n},f={path:`/digitalpaper`,categories:[`traditional-media`],example:`/stdaily/digitalpaper`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`科技日报`,maintainers:[`lyqluis`],handler:p};async function p(){let e=new Date,t=e.toLocaleDateString(`zh-CN`,{year:`numeric`,month:`2-digit`,day:`2-digit`}),r=t.replace(`/`,`-`),i=`http://digitalpaper.stdaily.com/http_www.kjrb.com/kjrb/html`,a=`${i}/${r}`,o=[],s=[],{pageLength:f,$:p}=await c(`${a}/node_2.htm`);s.push(...l(p,a));for(let e=2;e<=f;e++)o.push(u(a,e));s.push(...(await Promise.all(o.map(e=>e()))).flat());let m=await d(s,n);return{title:`科技日报`,link:`http://digitalpaper.stdaily.com`,item:m}}export{f as route};