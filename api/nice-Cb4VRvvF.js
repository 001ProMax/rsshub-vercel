import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{art as n}from"./render-DE4LRFBD.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{got_default as i}from"./got-BwctkUCD.js";import a from"node:path";import{load as o}from"cheerio";import s from"markdown-it";t();const c=s({html:!0}),l={path:`/nice`,categories:[`blog`],example:`/chuanliu/nice`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`chuanliu.org/nice`]}],name:`严选`,maintainers:[`nczitzk`],handler:u,url:`chuanliu.org/nice`};async function u(t){let s=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):100,l=`https://chuanliu.org`,u=`https://s.chuanliu.org`,d=new URL(`nice/`,l).href,f=new URL(`api/dis/api/v1/memo`,u).href,{data:p}=await i(f,{searchParams:{creatorId:1,offset:0,limit:s}}),m=p.slice(0,s).map(t=>{let i=t.content.split(/\n/),o=i?.[0].replace(/^#/,``)??void 0,s=i?.[1]??void 0,l=i?.[2]??void 0,u=i?.[3]??void 0,d=(i?.[5]&&i[5]===`star`)??!1;return d&&i.splice(5,1),{title:`${d?`[STAR] `:``}${s}`,link:l,description:n(a.join(e,`templates/description-0a74e693.art`),{description:c.render(i?.join(`

`)??``),images:t.resourceList.map(e=>({src:e.externalLink,alt:e.filename,type:e.type}))}),author:u,category:[o,d?`STAR`:void 0].filter(Boolean),guid:`chuanliu-nice#${t.id}`,pubDate:r(t.createdTs,`X`),updated:r(t.updatedTs,`X`)}}),{data:h}=await i(d),g=o(h),_=new URL(g(`link[rel="shortcut icon"]`).prop(`href`),d).href;return{item:m,title:g(`title`).text(),link:d,description:g(`span.rainbow-text`).first().text(),language:g(`html`).prop(`lang`),icon:_,logo:_,subtitle:g(`title`).text(),author:g(`meta[name="author"]`).prop(`content`),allowEmpty:!0}}export{l as route};