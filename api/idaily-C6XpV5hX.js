import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{art as n}from"./render-DE4LRFBD.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{got_default as i}from"./got-BwctkUCD.js";import a from"node:path";import{load as o}from"cheerio";t();const s={path:[`/:language?`],name:`每日环球视野`,example:`/idaily`,maintainers:[`zphw`,`nczitzk`],parameters:{language:`语言，见下表，默认为简体中文`},radar:[{source:[`idai.ly/`]}],handler:c,description:`| 简体中文 | 繁体中文 |
| -------- | -------- |
| zh-hans  | zh-hant  |`};async function c(t){let{language:s=`zh-hans`}=t.req.param(),c=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):100,l=`https://idaily-cdn.idailycdn.com`,u=new URL(`api/list/v3/iphone/${s}`,l).href,d=`https://idai.ly`,{data:f}=await i(u),p=f.filter(e=>e.ui_sets?.caption_subtitle).slice(0,c).map(t=>{let i=t.ui_sets?.cover_landscape_hd_4k??t.cover_landscape_hd;return{title:`${t.ui_sets?.caption_subtitle} - ${t.title}`,link:t.link_share,description:n(a.join(e,`templates/description-2f40bb93.art`),{images:i?[{src:i,alt:t.ui_sets?.caption_subtitle??t.title}]:void 0,intro:t.content}),author:t.location,category:t.tags?.map(e=>e.name),guid:`idaily-${t.guid}`,pubDate:r(t.pubdate_timestamp,`X`),updated:r(t.lastupdate_timestamp,`X`),enclosure_url:i,enclosure_type:`image/${i.split(/\./).pop()}`}}),{data:m}=await i(d),h=o(m),g=h(`title`).text(),_=new URL(`img/idaily/logo_2x.png`,d).href;return{item:p,title:g,link:d,description:h(`meta[name="description"]`).prop(`content`),language:`zh`,image:_,subtitle:h(`meta[name="keywords"]`).prop(`content`),author:g.split(/\s/)[0],allowEmpty:!0}}export{s as route};