import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import{logger_default as n}from"./logger-BlLSmUdl.js";import"./proxy-kot7LoOQ.js";import{art as r}from"./render-DE4LRFBD.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{puppeteer_default as a}from"./puppeteer-DQCLzTv0.js";import o from"node:path";import{load as s}from"cheerio";t();const c={name:`漏洞`,categories:[`programming`],path:`/zeroday/vulnerability/:status?`,example:`/hitcon/zeroday/vulnerability`,parameters:{status:`漏洞状态，见下表`},maintainers:[`KarasuShin`],radar:[{source:[`zeroday.hitcon.org/vulnerability/:status?`]}],features:{requirePuppeteer:!0},handler:d,description:`| 缺省   | all  | closed | disclosed | patching |
| ------ | ---- | ------ | --------- | -------- |
| 活動中 | 全部 | 關閉   | 公開      | 修補中   |`},l=`https://zeroday.hitcon.org/vulnerability`,u={all:`全部`,closed:`關閉`,disclosed:`公開`,patching:`修補中`};async function d(t){let c=l,d=t.req.param(`status`);d&&(c+=`/${d}`);let f=await a(),p=await f.newPage();await p.setRequestInterception(!0),p.on(`request`,e=>{e.resourceType()===`document`?e.continue():e.abort()}),n.http(`Requesting ${c}`),await p.goto(c,{waitUntil:`domcontentloaded`});let m=await p.evaluate(()=>document.documentElement.innerHTML);await f.close();let h=s(m),g=h(`.zdui-strip-list>li`).toArray().map(t=>{let n=h(t).find(`.title a`),a=h(t).find(`.vul-data`),s=a.find(`.code`).contents().filter(function(){return this.nodeType===3}).text(),c=a.find(`.risk span`).eq(1).text(),l=a.find(`.vender`).find(`.v-name-full`).text(),u=a.find(`.status`).text().replace(`Status:`,``).trim(),d=a.find(`.date`).text().replace(`Date:`,``).trim(),f=a.find(`.zdui-author-badge`).find(`a>span`).text(),p=r(o.join(e,`templates/zeroday-08cb6861.art`),{code:s,risk:c,vender:l,status:u,date:d,reporter:f});return{title:n.text(),link:n.attr(`href`),description:p,pubDate:i(d)}});return{title:d?u[d]??`ZeroDay`:`活動中`,link:c,item:g,image:`https://zeroday.hitcon.org/images/favicon/favicon.png`}}export{c as route};