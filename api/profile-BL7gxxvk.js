import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";import{timezone as r}from"./timezone-CCdTtC9I.js";import{fixArticleContent as i}from"./wechat-mp-DRebaZz-.js";import{load as a}from"cheerio";const o=`https://freewechat.com`,s={path:`/profile/:id`,categories:[`new-media`],example:`/freewechat/profile/MzI5NTUxNzk3OA==`,parameters:{id:`公众号 ID，可在URL中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`freewechat.com/profile/:id`]}],name:`公众号`,maintainers:[`TonyRL`],handler:c};async function c(s){let c=s.req.param(`id`),l=`${o}/profile/${c}`,{data:u}=await n(l),d=a(u),f=d(`h2`).text().trim(),p=d(`.main`).toArray().slice(0,-1).map(e=>{e=d(e);let t=e.find(`h3 a`);return{title:t.text().trim(),author:f,link:`${o}${t.attr(`href`)}`,description:e.find(`.preview`).text(),category:e.find(`.classification`).text().trim()}}),m=await Promise.all(p.map(o=>e.tryGet(o.link,async()=>{let e=await n(o.link,{headers:{Referer:l}}),s=a(e.data);return s(`.js_img_placeholder`).remove(),s(`amp-img`).each((e,t)=>{t=s(t),t.replaceWith(`<img src="${new URL(t.attr(`src`),o.link).href}" width="${t.attr(`width`)}" height="${t.attr(`height`)}" decoding="async">`)}),s(`amp-video`).each((e,t)=>{t=s(t),t.replaceWith(`<video width="${t.attr(`width`)}" height="${t.attr(`height`)}" controls poster="${t.attr(`poster`)}">${t.html()}</video>`)}),o.description=i(s(`#js_content`)),o.pubDate=r(t(s(`#publish_time`).text()),8),o})));return{title:d(`head title`).text(),link:l,image:`https://freewechat.com/favicon.ico`,item:m}}export{s as route};