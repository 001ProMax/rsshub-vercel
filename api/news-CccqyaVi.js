import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import{ofetch_default as e}from"./ofetch-CWQqZcqz.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{ViewType as n}from"./types-Bi82qguM.js";import{invalid_parameter_default as r}from"./invalid-parameter-CvwVNf6G.js";import{load as i}from"cheerio";const a={today:{label:`Today's News`,scene:12,view:14},"intrusion-daily-cyber-threat-alert":{label:`Cyberattacks`,scene:13,view:15},"ransomware-minute":{label:`Ransomware`,scene:16,view:18},cryptocrime:{label:`Cryptocrime`,scene:18,view:20},"hack-blotter":{label:`Hack Blotter`,scene:19,view:21},"cybersecurity-venture-capital-vc-deals":{label:`VC Deal Flow`,scene:3,view:3},"mergers-and-acquisitions-report":{label:`M&A Tracker`,scene:11,view:13}},o={name:`News`,categories:[`programming`],path:`/news/:category?`,example:`/cybersecurityventures/news`,radar:Object.keys(a).map(e=>({source:[`cybersecurityventures.com/${e}`],target:`/news/${e}`,title:a[e].label})),parameters:{category:{description:`news category`,default:`today`,options:Object.keys(a).map(e=>({value:e,label:a[e].label}))}},handler:s,maintainers:[`KarasuShin`],features:{supportRadar:!0},view:n.Articles};async function s(n){let o=`https://cybersecurityventures.com/`,s=`https://us-east-1-renderer-read.knack.com/v1`,c=n.req.param(`category`)??`today`,l=n.req.query(`limit`)??20;if(!(c in a))throw new r(`Invalid category`);let{scene:u,view:d,label:f}=a[c],p=await e(`${s}/scenes/scene_${u}/views/view_${d}/records?format=raw&page=1&rows_per_page=${l}&sort_field=field_2&sort_order=desc`,{headers:{"X-Knack-Application-Id":`6013171b60be8f001cb27363`,"X-Knack-Rest-Api-Key":`renderer`}});return{title:`${f} - Cybercrime Magazine`,link:`${o}/${c}`,item:p.records.map(e=>{let n=i(e.field_3,null,!1),r=n(`a`).attr(`href`),a=e.field_4,o=`<p>${a}</p><br>${n.html()}`;return{title:e.field_5,description:o,pubDate:t(e.field_2.iso_timestamp),link:r,guid:`cybersecurityventures:${e.id}`}})}}export{o as route};