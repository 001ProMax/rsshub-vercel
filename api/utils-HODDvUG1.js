import{config as e}from"./config-DYqAlsU3.js";import{cache_default as t}from"./cache-CvppK6AM.js";import{md5 as n}from"./md5-BJqXla8f.js";import{got_default as r}from"./got-BwctkUCD.js";const i=`newrank_cookie_token`,a=`newrank_cookie_count`,o=30,s=e=>{let t=[`0`,`1`,`2`,`3`,`4`,`5`,`6`,`7`,`8`,`9`,`a`,`b`,`c`,`d`,`e`,`f`],n=[...t],r=t.length,i,a,o=``,s=r-e;for(;r-- >s;)a=Math.floor((r+1)*Math.random()),i=n[a],o+=i;return o},c=(e,t,r)=>{let i=`/nr/user/login/loginByAccount?AppKey=joker&account=`+e+`&password=`+t+`&state=1&nonce=`+r;return n(i)},l=(e,t)=>{let r=`/xdnphb/detail/v1/rank/article/lists?AppKey=joker&account=`+e+`&nonce=`+t;return n(r)},u=e=>{let t=`/xdnphb/nr/cloud/douyin/detail/accountInfoAll?AppKey=joker&nonce=`+e;return n(t)},d=e=>{let t=`/xdnphb/nr/cloud/douyin/detail/aweme?AppKey=joker&nonce=`+e;return n(t)},f=e=>e.reduce((e,t)=>Array.isArray(t)?[...e,...f(t)]:[...e,t],[]);function p(e=!1){if(e)t.set(a,0);else{let e=t.get(a);e?e>o?(t.set(a,0),m()):t.set(a,e+1):t.set(a,1)}}function m(){t.set(i,null)}async function h(){p();let a=await t.get(i),o=String(e.newrank.username),l=n(n(String(e.newrank.password))+`daddy`),u=s(9),d=c(o,l,u);if(!a){let e=await r({method:`post`,url:`https://www.newrank.cn/nr/user/login/loginByAccount`,form:{account:o,password:l,state:1,nonce:u,xyz:d}}),n=e.headers[`set-cookie`];if(n)for(let e of n)e.indexOf(`token`)===0&&(a=e.split(`;`)[0]);t.set(i,a,600),p(!0)}return a}var g={getCookie:h,random_nonce:s,decrypt_wechat_detail_xyz:l,decrypt_douyin_account_xyz:u,decrypt_douyin_detail_xyz:d,flatten:f};export{g as utils_default$10};