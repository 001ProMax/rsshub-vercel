import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as n}from"./cache-CvppK6AM.js";import{art as r}from"./render-DE4LRFBD.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-BwctkUCD.js";import{timezone as o}from"./timezone-CCdTtC9I.js";import s from"node:path";t();const c={latest:{main:{id:10,slug:10,title:`最新`},"zh-tw":{id:395,slug:395,title:`最新`}},news:{main:{id:11,slug:11,title:`新闻`},"zh-tw":{id:396,slug:396,title:`資訊`}},notice:{main:{id:12,slug:12,title:`公告`},"zh-tw":{id:397,slug:397,title:`公告`}},activity:{main:{id:258,slug:258,title:`活动`},"zh-tw":{id:398,slug:398,title:`活動`}}},l={main:`https://ys.mihoyo.com`,"zh-tw":`https://genshin.hoyoverse.com`},u={main:`https://content-static.mihoyo.com`,"zh-tw":`https://api-os-takumi-static.hoyoverse.com`},d={main:`/main/news`,"zh-tw":`/zh-tw/news`},f={main:`/content/ysCn/getContentList`,"zh-tw":`/content_v2_user/app/a1b1f9d3315447cc/getContentList`},p={path:`/ys/:location?/:category?`,categories:[`game`],example:`/mihoyo/ys`,parameters:{location:"区域，可选 `main`（简中）或 `zh-tw`（繁中）",category:`分类，见下表，默认为最新`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`genshin.hoyoverse.com/:location/news`],target:`/ys/:location`}],name:`原神`,maintainers:[`nczitzk`],handler:m,description:`#### 新闻 {#mi-ha-you-yuan-shen-xin-wen}

| 最新   | 新闻 | 公告   | 活动     |
| ------ | ---- | ------ | -------- |
| latest | news | notice | activity |`};async function m(t){let p=t.req.param(`location`)??`main`,m=t.req.param(`category`)??`latest`,h=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):50,g={main:`pageNum=1&channelId=${c[m][p].id}&pageSize=${h}`,"zh-tw":`iPage=1&sLangKey=zh-tw&iChanId=${c[m][p].id}&iPageSize=${h}`},_=l[p],v=u[p],y=`${v}${f[p]}?${g[p]}`,b=`${_}${d[p]}/${c[m][p].slug}`,x=await a({method:`get`,url:y}),S=x.data.data.list,C=``,w=p===`main`?S.map(e=>(C=e.ext.filter(e=>e.arrtName===`banner`),{author:e.author,title:e.title.trim(),pubDate:o(i(e.start_time),8),link:`${_}/main/news/detail/${e.contentId}`,image:C.value?C.value[0].url:void 0})):S.map(t=>(C=t.sExt?JSON.parse(t.sExt).banner:void 0,{author:t.sAuthor,title:t.sTitle.split(`｜`)[0],pubDate:o(i(t.dtCreateTime),8),link:`${_}/zh-tw/news/detail/${t.contentId}`,description:r(s.join(e,`templates/ys-3a20c230.art`),{image:C?C[0].url:void 0,description:t.sContent})}));return p===`main`&&(w=await Promise.all(w.map(t=>n.tryGet(t.link,async()=>{let n=await a({method:`get`,url:t.link});try{t.description=r(s.join(e,`templates/ys-3a20c230.art`),{image:t.image,description:JSON.parse(n.data.match(/,content:(".*?"),ext:/)[1].trim())})}catch{}return delete t.image,t})))),{title:`原神 - ${c[m][p].title}`,link:b,item:w}}export{p as route};