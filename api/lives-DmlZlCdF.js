import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CDAeBYLA.js";import"./helpers-RrXnNmv1.js";import{art as n}from"./render-DlHIMz-Z.js";import{parseDate as r}from"./parse-date-B2cCVoGk.js";import{got_default as i}from"./got-Cw4D6IS5.js";import{ViewType as a}from"./types-DygLf1a3.js";import o from"node:path";import{load as s}from"cheerio";t();const c={0:`全部`,1:`精选`,2:`政策`,3:`数据`,4:`NFT`,5:`项目`},l={path:`/lives/:category?`,categories:[`finance`,`popular`],view:a.Notifications,example:`/jinse/lives`,parameters:{category:{description:`分类`,options:Object.entries(c).map(([e,t])=>({value:e,label:t})),default:`0`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`快讯`,maintainers:[`nczitzk`],handler:u,description:`| 全部 | 精选 | 政策 | 数据 | NFT | 项目 |
| ---- | ---- | ---- | ---- | --- | ---- |
| 0    | 1    | 2    | 3    | 4   | 5    |`};async function u(t){let{category:a=`0`}=t.req.param(),l=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):100,u=`https://jinse.cn`,d=`https://api.jinse.cn`,f=new URL(`noah/v2/lives`,d).href,p=new URL(`lives`,u).href,{data:m}=await i(f,{searchParams:{limit:l,reading:!1,source:`web`,flag:`up`,id:0,category:a}}),h=m.list.flatMap(e=>e.lives).slice(0,l).map(t=>({title:t.content_prefix,link:new URL(`lives/${t.id}.html`,u).href,description:n(o.join(e,`templates/description-d03b585b.art`),{images:t.images?.map(e=>({src:e.url.replace(/_[^\W_]+(\.\w+)$/,`_true$1`),width:e.width,height:e.height}))??[],description:t.content,original:t.link?{link:t.link,name:t.link_name}:void 0}),author:t.show_source_name,guid:`jinse-lives-${t.id}`,pubDate:r(t.created_at,`X`),upvotes:t.up_counts??0,downvotes:t.down_counts??0,comments:t.comment_count??0}))??[],{data:g}=await i(p),_=s(g),v=_(`meta[name="author"]`).prop(`content`),y=_(`a.js-logoBox img`).prop(`src`),b=new URL(_(`link[rel="favicon"]`).prop(`href`),u).href;return{item:h,title:`${v} - ${Object.hasOwn(c,a)?c[a]:a}`,link:p,description:_(`meta[name="description"]`).prop(`content`),language:_(`html`).prop(`lang`),image:y,icon:b,logo:b,subtitle:_(`meta[name="keywords"]`).prop(`content`),author:v,allowEmpty:!0}}export{l as route};