import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import{ofetch_default as e}from"./ofetch-CWQqZcqz.js";import{cache_default as t}from"./cache-CvppK6AM.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ViewType as r}from"./types-Bi82qguM.js";import{load as i}from"cheerio";const a=async r=>{let{category:a=`cardgame`}=r.req.param(),o=Number.parseInt(r.req.query(`limit`)??`18`,10),s=`https://app.mycard520.com.tw`,c=new URL(`category/${a.endsWith(`/`)?a:`${a}/`}`,s).href,l=await e(c),u=i(l),d=u(`html`).attr(`lang`)??`zh-TW`,f=[];return u(`div.page_numbers`).remove(),f=u(`div#tab1 ul li`).slice(0,o).toArray().map(e=>{let t=u(e),r=t.find(`a`),i=t.find(`div.text_box p`).text(),a=r.html()??void 0,o=t.find(`div.date`).text().trim(),s=r.attr(`href`),c=t.find(`div.img_box img`).attr(`src`),l=o,f={title:i,description:a,pubDate:o?n(o):void 0,link:s,content:{html:a??``,text:a??``},image:c,banner:c,updated:l?n(l):void 0,language:d};return f}),f=(await Promise.all(f.map(r=>r.link?t.tryGet(r.link,async()=>{let t=await e(r.link),a=i(t),o=a(`div.page_box`),s=o.find(`h2`).text(),c=a(`div.date`).first().text(),l=c,u=o.children().toArray().map((e,t)=>({el:e,index:t})).filter(({el:e})=>e.tagName===`div`&&e.attributes.some(e=>e.name===`style`&&e.value.split(`;`).some(e=>e.trim()===`clear:both`))).reduce((e,{index:t})=>t,-1);u!==-1&&o.children().slice(0,u).remove();let f=o.html()??r.description,p={title:s,description:f,pubDate:c?n(c):r.pubDate,content:{html:f??``,text:f??``},updated:l?n(l):r.updated,language:d};return{...r,...p}}):r))).filter(e=>!0),{title:u(`title`).text(),description:u(`meta[name="keywords"]`).attr(`content`),link:c,item:f,allowEmpty:!0,image:u(`div.logo img`).attr(`src`),author:u(`title`).text().split(/-/).pop()?.trim(),language:d,id:c}},o={path:`/category/:category?`,name:`遊戲新聞`,url:`app.mycard520.com.tw`,maintainers:[`nczitzk`],handler:a,example:`/mycard520/category/cardgame`,parameters:{category:{description:"分类，默认为 `cardgame`，即最新遊戲，可在对应分类页 URL 中找到",options:[{label:`最新遊戲`,value:`cardgame`},{label:`手機遊戲`,value:`cardgame-mobile`},{label:`PC 遊戲`,value:`cardgame-pc`},{label:`電競賽事`,value:`cardgame-esports`},{label:`實況直播`,value:`cardgame-live`}]}},description:":::tip\n若订阅 [最新遊戲](https://app.mycard520.com.tw/category/cardgame/)，网址为 `https://app.mycard520.com.tw/category/cardgame/`，请截取 `https://app.mycard520.com.tw/category/` 到末尾 `/` 的部分 `cardgame` 作为 `category` 参数填入，此时目标路由为 [`/mycard520/category/cardgame`](https://rsshub.app/mycard520/category/cardgame)。\n:::\n\n| [最新遊戲](https://app.mycard520.com.tw/category/cardgame/) | [手機遊戲](https://app.mycard520.com.tw/category/cardgame-mobile/)       | [PC 遊戲](https://app.mycard520.com.tw/category/cardgame-pc/)    | [電競賽事](https://app.mycard520.com.tw/category/cardgame-esports/)        | [實況直播](https://app.mycard520.com.tw/category/cardgame-live/)     |\n| ----------------------------------------------------------- | ------------------------------------------------------------------------ | ---------------------------------------------------------------- | -------------------------------------------------------------------------- | -------------------------------------------------------------------- |\n| [cardgame](https://rsshub.app/mycard520/category/cardgame)  | [cardgame-mobile](https://rsshub.app/mycard520/category/cardgame-mobile) | [cardgame-pc](https://rsshub.app/mycard520/category/cardgame-pc) | [cardgame-esports](https://rsshub.app/mycard520/category/cardgame-esports) | [cardgame-live](https://rsshub.app/mycard520/category/cardgame-live) |\n",categories:[`game`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`app.mycard520.com.tw/category/:category`],target:e=>{let t=e.category;return`/mycard520${t?`/${t}`:``}`}},{title:`最新遊戲`,source:[`app.mycard520.com.tw/category/cardgame`],target:`/category/cardgame`},{title:`手機遊戲`,source:[`app.mycard520.com.tw/category/cardgame-mobile`],target:`/category/cardgame-mobile`},{title:`PC 遊戲`,source:[`app.mycard520.com.tw/category/cardgame-pc`],target:`/category/cardgame-pc`},{title:`電競賽事`,source:[`app.mycard520.com.tw/category/cardgame-esports`],target:`/category/cardgame-esports`},{title:`實況直播`,source:[`app.mycard520.com.tw/category/cardgame-live`],target:`/category/cardgame-live`}],view:r.Articles,zh:{path:`/category/:category?`,name:`游戏新闻`,url:`app.mycard520.com.tw`,maintainers:[`nczitzk`],handler:a,example:`/mycard520/category/cardgame`,parameters:{category:{description:"分类，默认为 `cardgame`，即最新游戏，可在对应分类页 URL 中找到",options:[{label:`最新游戏`,value:`cardgame`},{label:`手机游戏`,value:`cardgame-mobile`},{label:`PC 游戏`,value:`cardgame-pc`},{label:`电竞赛事`,value:`cardgame-esports`},{label:`实况直播`,value:`cardgame-live`}]}},description:":::tip\n若订阅 [最新游戏](https://app.mycard520.com.tw/category/cardgame/)，网址为 `https://app.mycard520.com.tw/category/cardgame/`，请截取 `https://app.mycard520.com.tw/category/` 到末尾 `/` 的部分 `cardgame` 作为 `category` 参数填入，此时目标路由为 [`/mycard520/category/cardgame`](https://rsshub.app/mycard520/category/cardgame)。\n:::\n\n| [最新游戏](https://app.mycard520.com.tw/category/cardgame/) | [手机游戏](https://app.mycard520.com.tw/category/cardgame-mobile/)       | [PC 游戏](https://app.mycard520.com.tw/category/cardgame-pc/)    | [电竞赛事](https://app.mycard520.com.tw/category/cardgame-esports/)        | [实况直播](https://app.mycard520.com.tw/category/cardgame-live/)     |\n| ----------------------------------------------------------- | ------------------------------------------------------------------------ | ---------------------------------------------------------------- | -------------------------------------------------------------------------- | -------------------------------------------------------------------- |\n| [cardgame](https://rsshub.app/mycard520/category/cardgame)  | [cardgame-mobile](https://rsshub.app/mycard520/category/cardgame-mobile) | [cardgame-pc](https://rsshub.app/mycard520/category/cardgame-pc) | [cardgame-esports](https://rsshub.app/mycard520/category/cardgame-esports) | [cardgame-live](https://rsshub.app/mycard520/category/cardgame-live) |\n"}};export{a as handler,o as route};