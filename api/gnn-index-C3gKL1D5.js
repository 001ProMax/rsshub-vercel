import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CDAeBYLA.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-7MGQxbL-.js";import{parseDate as t}from"./parse-date-B2cCVoGk.js";import{got_default as n}from"./got-Cw4D6IS5.js";import{ViewType as r}from"./types-DygLf1a3.js";import{timezone as i}from"./timezone-1BLOtscE.js";import{load as a}from"cheerio";const o={path:`/gnn/:category?`,categories:[`anime`,`popular`],view:r.Articles,example:`/gamer/gnn/1`,parameters:{category:{description:`版塊`,options:[{value:`1`,label:`PC`},{value:`3`,label:`TV 掌機`},{value:`4`,label:`手機遊戲`},{value:`5`,label:`動漫畫`},{value:`9`,label:`主題報導`},{value:`11`,label:`活動展覽`},{value:`13`,label:`電競`},{value:`ns`,label:`Switch`},{value:`ps5`,label:`PS5`},{value:`ps4`,label:`PS4`},{value:`xbone`,label:`XboxOne`},{value:`xbsx`,label:`XboxSX`},{value:`pc`,label:`PC 單機`},{value:`olg`,label:`PC 線上`},{value:`ios`,label:`iOS`},{value:`android`,label:`Android`},{value:`web`,label:`Web`},{value:`comic`,label:`漫畫`},{value:`anime`,label:`動畫`}]}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`GNN 新聞`,maintainers:[`Arracc`,`ladeng07`,`pseudoyu`],handler:s,description:`缺省為首頁`};async function s(r){let o=r.req.param(`category`),s=``,c=``,l={1:`PC`,3:`TV 掌機`,4:`手機遊戲`,5:`動漫畫`,9:`主題報導`,11:`活動展覽`,13:`電競`,ns:`Switch`,ps5:`PS5`,ps4:`PS4`,xbone:`XboxOne`,xbsx:`XboxSX`,pc:`PC 單機`,olg:`PC 線上`,ios:`iOS`,android:`Android`,web:`Web`,comic:`漫畫`,anime:`動畫`},u=[`1`,`3`,`4`,`5`,`9`,`11`,`13`];!o||!Object.keys(l).includes(o)?s=`https://gnn.gamer.com.tw/`:(c=`-`+l[o],s=u.includes(o)?`https://gnn.gamer.com.tw/index.php?k=${o}`:`https://acg.gamer.com.tw/news.php?p=${o}`);let d=await n({method:`get`,url:s}),f=d.data,p=r.req.query(`limit`)?Number.parseInt(r.req.query(`limit`)):50,m=a(f),h=m(`div.BH-lbox.GN-lbox2`).children().not(`p,a,img,span`).slice(0,p).map((e,t)=>{t=m(t);let n,r;return t.find(`h1`).length===0?(n=t.find(`a`),r=t.find(`div.platform-tag_list`).text()):(n=t.find(`h1`).find(`a`),r=t.find(`div.platform-tag_list`).text()),{title:`[`+r+`]`+n.text(),link:n.attr(`href`).replace(`//`,`https://`)}}).get(),g=await Promise.all(h.map(async r=>(r.description=await e.tryGet(r.link,async()=>{let e=await n.get(r.link),o=``,s=/window\.lazySizesConfig/g,c,l;if(e.body.search(s)>=0){let t=a(e.data);t(`span.GN-lbox3C`).length>0?(c=t(`span.GN-lbox3C`).text().split(`）`),r.author=c[0].replace(`（`,``).replace(` 報導`,``),l=c[1].trim()):(c=t(`span.GN-lbox3CA`).text().split(`）`),r.author=c[0].replace(`（`,``).replace(` 報導`,``),l=c[1].replace(`原文出處`,``).trim()),o=t(`div.GN-lbox3B`).html()}else{let e=await n.get(r.link),t=a(e.data);t(`div.MSG-list8C`).length>0?(c=t(`span.ST1`).text().split(`│`),r.author=c[0].replace(`作者：`,``),l=c[t(`span.ST1`).find(`a`).length>0?2:1],o=t(`div.MSG-list8C`).html()):(c=t(`div.article-intro`).text().replaceAll(`
`,``).split(`|`),r.author=c[0],l=c[1],o=t(`div.text-paragraph`).html())}return r.pubDate=i(t(l,`YYYY-MM-DD HH:mm:ss`),8),o=o.replaceAll(/\b(data-src)\b/g,`src`),o}),r)));return{title:`巴哈姆特-GNN新聞`+c,link:s,item:g}}export{o as route};