import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import{logger_default as e}from"./logger-BlLSmUdl.js";import"./proxy-kot7LoOQ.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import"./cache-CvppK6AM.js";import"./render-DE4LRFBD.js";import"./md5-BJqXla8f.js";import{got_default as t}from"./got-BwctkUCD.js";import{ViewType as n}from"./types-Bi82qguM.js";import"./puppeteer-DQCLzTv0.js";import{getVideoUrl as r,utils_default as i}from"./utils-CsTdEpjv.js";import{cache_default$1 as a}from"./cache-COOjRm1i.js";const o={path:`/user/video/:uid/:embed?`,categories:[`social-media`,`popular`],view:n.Videos,example:`/bilibili/user/video/2267573`,parameters:{uid:`用户 id, 可在 UP 主主页中找到`,embed:`默认为开启内嵌视频, 任意值为关闭`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`space.bilibili.com/:uid`],target:`/user/video/:uid`}],name:`UP 主投稿`,maintainers:[`DIYgod`,`Konano`,`pseudoyu`],handler:s};async function s(n){let o=n.req.param(`uid`),s=!n.req.param(`embed`),c=await a.getCookie(),l=await a.getWbiVerifyString(),u=i.getDmImgList(),d=i.getDmImgInter(),f=await a.getRenderData(o),[p,m]=await a.getUsernameAndFaceFromUID(o),h=i.addWbiVerifyInfo(i.addRenderData(i.addDmVerifyInfoWithInter(`mid=${o}&ps=30&tid=0&pn=1&keyword=&order=pubdate&platform=web&web_location=1550101&order_avoided=true`,u,d),f),l),g=await t(`https://api.bilibili.com/x/space/wbi/arc/search?${h}`,{headers:{Referer:`https://space.bilibili.com/${o}/video?tid=0&pn=1&keyword=&order=pubdate`,Cookie:c}}),_=g.data;if(_.code)throw e.error(JSON.stringify(_.data)),Error(`Got error code ${_.code} while fetching: ${_.message}`);return{title:`${p} 的 bilibili 空间`,link:`https://space.bilibili.com/${o}`,description:`${p} 的 bilibili 空间`,image:m,logo:m,icon:m,item:_.data&&_.data.list&&_.data.list.vlist&&_.data.list.vlist.map(e=>({title:e.title,description:i.renderUGCDescription(s,e.pic,e.description,e.aid,void 0,e.bvid),pubDate:new Date(e.created*1e3).toUTCString(),link:e.created>i.bvidTime&&e.bvid?`https://www.bilibili.com/video/${e.bvid}`:`https://www.bilibili.com/video/av${e.aid}`,author:p,comments:e.comment,attachments:e.bvid?[{url:r(e.bvid),mime_type:`text/html`}]:void 0}))}}export{o as route};