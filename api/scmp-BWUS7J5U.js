import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";import{parseItem$7 as r}from"./utils-Czdhbnh-.js";import{load as i}from"cheerio";const a={path:`/:category_id`,categories:[`traditional-media`],example:`/scmp/3`,parameters:{category_id:`Category`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`scmp.com/rss/:category_id/feed`]}],name:`News`,maintainers:[`proletarius101`],handler:o,description:`See the [official RSS page](https://www.scmp.com/rss) to get the ID of each category. This route provides fulltext that the offical feed doesn't.`};async function o(a){let o=a.req.param(`category_id`),s=`https://www.scmp.com/rss/${o}/feed`,{data:c}=await n(s),l=i(c,{xmlMode:!0}),u=l(`item`).toArray().map(e=>{let n=l(e),r=n.find(`enclosure`).first(),i=n.find(String.raw`media\:content`).toArray()[0],a=n.find(String.raw`media\:thumbnail`).toArray()[0];return{title:n.find(`title`).text(),description:n.find(`description`).text(),link:n.find(`link`).text().split(`?utm_source`)[0],author:n.find(`author`).text(),pubDate:t(n.find(`pubDate`).text()),enclosure_url:r?.attr(`url`),enclosure_length:r?.attr(`length`),enclosure_type:r?.attr(`type`),media:{content:Object.keys(i.attribs).reduce((e,t)=>(e[t]=i.attribs[t],e),{}),thumbnail:a?.attribs?Object.keys(a.attribs).reduce((e,t)=>(e[t]=a.attribs[t],e),{}):void 0}}}),d=await Promise.all(u.map(t=>e.tryGet(t.link,()=>r(t))));return a.set(`json`,{items:d}),{title:l(`channel > title`).text(),link:l(`channel > link`).text(),description:l(`channel > description`).text(),item:d,language:`en-hk`,icon:`https://assets.i-scmp.com/static/img/icons/scmp-icon-256x256.png`,logo:`https://customerservice.scmp.com/img/logo_scmp@2x.png`,image:l(`channel > image > url`).text()}}export{a as route};