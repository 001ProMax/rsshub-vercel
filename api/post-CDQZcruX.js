import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{parseDate as e}from"./parse-date-DHsdom8D.js";import{got_default as t}from"./got-BwctkUCD.js";const n={path:`/post/:type?`,categories:[`bbs`],example:`/loongarch/post/newest`,parameters:{type:`top 或 newest`},radar:[{source:[`bbs.loongarch.org`]}],name:`最热 / 最新帖子`,maintainers:[`ladeng07`,`3401797899`],handler:r,url:`bbs.loongarch.org/`};async function r(n){let r=n.req.param(`type`),i=`https://bbs.loongarch.org/api/discussions`,a=`最新帖子`,o=`-createdAt`;r===`top`&&(a=`最热帖子`,o=`-commentCount`);let{data:s}=await t(`https://bbs.loongarch.org/api/discussions`,{searchParams:{include:`user,tags,tags.parent,firstPost`,sort:o,"page[offset]":0}}),c=s.included.filter(e=>e.type===`users`),l=s.included.filter(e=>e.type===`tags`),u=s.included.filter(e=>e.type===`posts`),d=s.data.map(({attributes:t,relationships:n})=>({title:t.title,link:`https://bbs.loongarch.org/d/${t.slug}`,author:c.find(e=>e.id===n.user.data.id).attributes.displayName,description:u.find(e=>e.id===n.firstPost.data.id).attributes.contentHtml,pubDate:e(t.createdAt),updated:e(t.lastPostedAt),category:n.tags.data.map(e=>l.find(t=>t.id===e.id).attributes.name)}));return{title:`LA UOSC-${a}`,link:i,description:`LA UOSC-${a}`,item:d}}export{n as route};