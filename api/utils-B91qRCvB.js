import e from"crypto";import t from"crypto-js";import{KEYUTIL as n,KJUR as r,hextob64 as i}from"jsrsasign";const a=`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCARnxLlrhTK28bEV7s2IROjT73KLSjfqpKIvV8L+Yhe4BrF0Ut4oOH728HZlbSF0C3N0vXZjLAFesoS4v1pYOjVCPXl920Lh2seCv82m0cK78WMGuqZTfA44Nv7JsQMHC3+J6IZm8YD53ft2d8mYBFgKektduucjx8sObe7eRyoQIDAQAB`,o=e=>{if(e>32)throw Error(`Max length is 32.`);return s().replaceAll(`-`,``).substring(0,e)},s=()=>e.randomUUID(),c=e=>t.MD5(e),l=(e,n)=>(typeof n==`string`&&(n=c(n)),t.AES.encrypt(t.enc.Utf8.parse(e),n,{mode:t.mode.ECB,padding:t.pad.Pkcs7}).toString()),u=(e,n)=>(typeof n==`string`&&(n=c(n)),t.AES.decrypt(e,n,{mode:t.mode.ECB,padding:t.pad.Pkcs7}).toString(t.enc.Utf8)),d=e=>{let t=`-----BEGIN PUBLIC KEY-----${a}-----END PUBLIC KEY-----`;return t=n.getKey(t),i(r.crypto.Cipher.encrypt(e,t))},f=e=>{let t=s();return{"content-type":`application/json`,"ovse-trace":s(),callertype:`USER`,fingerprint:l(t,c(e)),onetimeskey:d(e),timestamp:l(Date.now(),e),referer:`https://www.ainvest.com/`}};export{u as decryptAES,l as encryptAES,f as getHeaders,o as randomString};