import{ofetch_default as e}from"./ofetch-CWQqZcqz.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import*as n from"cheerio";import r from"crypto-js";const i=`4bTogwpz7RzNO2VTFtW7zcfRkAE97ox6ZSgcQi7FgYdqrHqKB7aGqEZ4o7yssa2aEXoV3bQwh12FFgVNlpyYk2Yjm9d2EZGeGu3`,a=`https://3g.dxy.cn`,o=`https://www.dxy.cn`,s=(e=8,t=`alphabet`)=>{let n={alphabet:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz`,number:`0123456789`},r=``,i=n[t]||n.alphabet;for(let t=0;t<e;t++)r+=i.charAt(Math.floor(Math.random()*i.length));return r},c=e=>{let t=new URLSearchParams(e);return t.append(`appSignKey`,i),t.sort(),r.SHA1(t.toString()).toString()},l=(r,i)=>i(r.link,async()=>{let i={postId:r.postId,serverTimestamp:Date.now(),timestamp:Date.now(),noncestr:s(8,`number`)},a=await e(`https://www.dxy.cn/bbs/newweb/post/detail`,{query:{...i,sign:c(i)}});if(a.code!==`success`)throw Error(a.message);let o=n.load(a.data.body,null,!1);return o(`img`).each((e,t)=>{t=o(t),t.data(`hsrc`)&&(t.attr(`src`,t.data(`hsrc`)),t.removeAttr(`data-hsrc`)),t.data(`osrc`)&&(t.attr(`src`,t.data(`osrc`)),t.removeAttr(`data-osrc`))}),r.description=o.html(),r.pubDate=t(a.data.createTime,`x`),r.updated=a.data.lastEditTime?t(a.data.lastEditTime,`x`):r.pubDate,r.category=[...new Set([...r.category,...a.data.tagInfos.map(e=>e.tagName)])],r});export{s as generateNonce,l as getPost,a as phoneBaseUrl,c as sign,o as webBaseUrl};