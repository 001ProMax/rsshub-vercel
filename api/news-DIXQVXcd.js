import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import{ofetch_default as e}from"./ofetch-CWQqZcqz.js";import{cache_default as t}from"./cache-CvppK6AM.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{timezone as r}from"./timezone-CCdTtC9I.js";import*as i from"cheerio";let a=function(e){return e.English=`en`,e.Japanese=`jp`,e.Korean=`kr`,e.Chinese=`zh`,e.ChineseTaiwan=`zh-tw`,e.Spanish=`es`,e.French=`fr`,e.German=`de`,e}({}),o=function(e){return e.Limit=`limit`,e.Language=`language`,e}({});const s=Object.values(a),c=(e,t)=>{if(typeof e==`number`)return e;if(e===void 0)return t===void 0?NaN:t;let n=Number.parseInt(e,10);return t!==void 0&&Number.isNaN(n)?t:n},l=e=>s.includes(e),u=t=>t===a.Chinese?e(`https://media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/zh/ArticleMenu.json`,{query:{t:Date.now()}}):e(`https://hw-media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/${t}/MainMenu.json`).then(e=>e.article),d=(e,t)=>e===a.Chinese?`https://media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/zh/article/${t}.json`:`https://hw-media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/${e}/article/${t}.json`,f=(e,t)=>e===a.Chinese?`https://mc.kurogames.com/main/news/detail/${t}`:`https://wutheringwaves.kurogames.com/${e}/main/news/detail/${t}`,p=e=>{switch(e){case a.English:return`en`;case a.Chinese:return`zh-CN`;case a.ChineseTaiwan:return`zh-TW`;case a.French:return`fr`;case a.German:return`de`;case a.Japanese:return`ja`;case a.Korean:return`ko`;case a.Spanish:return`es`;default:throw Error(`Could not resolve handler language from "${e}"`)}},m={path:`/wutheringwaves/news/:${o.Language}?`,categories:[`game`],example:`/kurogames/wutheringwaves/news`,parameters:{[o.Language]:"The language to use for the content. Default: `zh`."},name:`鸣潮 — 游戏公告、新闻与活动`,radar:[{source:[`mc.kurogames.com/m/main/news`,`mc.kurogames.com/main`]},{title:`Wuthering Waves — Game announcements, news and events`,source:[`wutheringwaves.kurogames.com/en/main/news`,`wutheringwaves.kurogames.com/en/main`]}],maintainers:[`goestav`,`enpitsulin`],description:`
Language codes for the \`${o.Language}\` parameter:

| Language | Code         |
|----------|--------------|
| English  | en           |
| 日本語    | jp           |
| 한국어     | kr           |
| 简体中文   | zh (default) |
| 繁體中文   | zh-tw        |
| Español  | es           |
| Français | fr           |
| Deutsch  | de           |
    `,async handler(m){let h=m.req.query(o.Limit),g=m.req.param(o.Language),_=c(h,30),v=g||a.Chinese;if(!l(v))throw TypeError(`Language parameter is not valid. Please use one of the following: ${s.join(`, `)}`);let y=await u(v),b=y.filter(e=>e.articleType!==0).slice(0,_),x=await Promise.all(b.map(a=>{let o=d(v,a.articleId),s={title:a.articleTitle,pubDate:r(n(a.createTime),8),link:f(v,a.articleId)};return t.tryGet(`wutheringwaves:${v}:${a.articleId}`,async()=>{let{articleContent:t}=await e(o,{query:{t:Date.now()}}),n=i.load(t);return s.description=n.html()??a.articleDesc??``,s})})),S=v===a.Chinese?`《鸣潮》— 游戏公告、新闻和活动`:`Wuthering Waves - Announcements, News and Events`,C=v===a.Chinese?`https://mc.kurogames.com/main#news`:`https://wutheringwaves.kurogames.com/${v}/main/#news`;return{title:S,link:C,item:x,language:p(v)}}};export{m as route};