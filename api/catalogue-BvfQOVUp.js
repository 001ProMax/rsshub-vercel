import{__dirname as e,init_esm_shims as t}from"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as n}from"./cache-CvppK6AM.js";import{art as r}from"./render-DE4LRFBD.js";import{parseDate as i}from"./parse-date-DHsdom8D.js";import{got_default as a}from"./got-BwctkUCD.js";import o from"node:path";import{load as s}from"cheerio";t();const c={zhengce:`政策`,fenxishishuo:`行情`,defi:`DeFi`,kuang:`矿业`,"以太坊2.0":`以太坊 2.0`,industry:`产业`,IPFS:`IPFS`,tech:`技术`,baike:`百科`,capitalmarket:`研报`},l={path:`/:category?`,categories:[`finance`],example:`/jinse/zhengce`,parameters:{category:`分类，见下表，默认为政策`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`分类`,maintainers:[`nczitzk`],handler:u,description:`| 政策    | 行情         | DeFi | 矿业  | 以太坊 2.0 |
| ------- | ------------ | ---- | ----- | ---------- |
| zhengce | fenxishishuo | defi | kuang | 以太坊 2.0 |

| 产业     | IPFS | 技术 | 百科  | 研报          |
| -------- | ---- | ---- | ----- | ------------- |
| industry | IPFS | tech | baike | capitalmarket |`};async function u(t){let{category:l=`zhengce`}=t.req.param(),u=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):50,d=`https://www.jinse.cn`,f=`https://api.jinse.cn`,p=new URL(`v6/www/information/list`,f).href,m=d,{data:h}=await a(p,{searchParams:{catelogue_key:l,limit:u,flag:`up`}}),g=h.list.slice(0,u).map(t=>({title:t.title,link:t.extra.topic_url,description:r(o.join(e,`templates/description-d03b585b.art`),{images:t.extra.thumbnails_pics.length>0?t.extra.thumbnails_pics.map(e=>({src:e.replace(/_[^\W_]+(\.\w+)$/,`_true$1`)})):void 0,intro:t.extra.summary}),author:t.extra.nickname,guid:`jinse${/\/lives\//.test(t.extra.topic_url)?`-lives`:``}-${t.extra.topic_id}`,pubDate:i(t.extra.published_at,`X`),upvotes:t.extra.up_counts??0,downvotes:t.extra.down_counts??0,comments:t.extra.comment_count??0}));g=await Promise.all(g.map(t=>n.tryGet(t.link,async()=>{if(/\/lives\//.test(t.link))return t;let{data:n}=await a(t.link),i=s(n);return t.description+=r(o.join(e,`templates/description-d03b585b.art`),{description:i(`section.js-article-content`).html()||i(`div.js-article`).html()}),t.category=i(`section.js-article-tag_state_1 a span`).toArray().map(e=>i(e).text()),t})));let{data:_}=await a(m),v=s(_),y=v(`meta[name="author"]`).prop(`content`),b=v(`a.js-logoBox img`).prop(`src`),x=new URL(v(`link[rel="favicon"]`).prop(`href`),d).href;return{item:g,title:`${y} - ${Object.hasOwn(c,l)?c[l]:l}`,link:m,description:v(`meta[name="description"]`).prop(`content`),language:v(`html`).prop(`lang`),image:b,icon:x,logo:x,subtitle:v(`meta[name="keywords"]`).prop(`content`),author:y,allowEmpty:!0}}export{l as route};