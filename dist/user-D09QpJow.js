import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";const r={path:`/user/:user`,categories:[`social-media`],example:`/rattibha/user/elonmusk`,parameters:{user:`Twitter username, without @`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`rattibha.com/:user`]}],name:`User Threads`,maintainers:[`yshalsager`],handler:i};async function i(r){let i=`https://rattibha.com`,{user:a}=r.req.param(),{data:{user:o}}=await n(`${i}/user?id=${a}`,{headers:{accept:`application/json`}}),{data:s}=await n(`${i}/u_threads?id=${o.account_user_id}`,{headers:{accept:`application/json`}}),c=s.map(e=>({title:e.thread.t.info.text,link:`${i}/thread/${e.thread_id}`,pubDate:t(e.thread.created_at),updated:t(e.thread.updated_at),author:o.name,threadData1URL:`${i}/thread?id=${e.thread_id}`,threadData2URL:`${i}/threads?id=${e.thread_id}`})),l=await Promise.all(c.map(t=>e.tryGet(t.link,async()=>{let{data:e}=await n(t.threadData1URL,{headers:{accept:`application/json`}}),{data:r}=await n(t.threadData2URL,{headers:{accept:`application/json`}});return t.description=[...e.tweets,...r].reduce((e,t)=>`${e}${t.tweet_detail.info.text}<br>`,``),t})));return{title:`سلاسل تغريدات ${a}`,link:`${i}/${a}`,item:l}}export{r as route};