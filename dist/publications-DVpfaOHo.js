import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./proxy-kot7LoOQ.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{puppeteer_default as n}from"./puppeteer-DQCLzTv0.js";import{load as r}from"cheerio";const i={path:`/publications/:id`,radar:[{source:[`researchgate.net/profile/:username`],target:`/publications/:username`}],name:`Unknown`,maintainers:[],handler:a};async function a(i){let a=i.req.param(`id`),o=`https://www.researchgate.net`,s=`${o}/profile/${a}`,c=await n(),l=await c.newPage();await l.setRequestInterception(!0),l.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),await l.goto(s);let u=await l.evaluate(()=>document.documentElement.innerHTML);await l.close();let d=r(u),f=d(`div[itemprop="headline"] a`).toArray().slice(0,i.req.query(`limit`)?Number(i.req.query(`limit`)):15).map(e=>(e=d(e),{title:e.text(),link:e.attr(`href`)})),p=await Promise.all(f.map(n=>e.tryGet(n.link,async()=>{let e=await c.newPage();await e.setRequestInterception(!0),e.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),await e.goto(n.link);let i=await e.evaluate(()=>document.documentElement.innerHTML);await e.close();let a=r(i);n.doi=a(`meta[property="citation_doi"]`).attr(`content`),n.pubDate=t(a(`meta[property="citation_publication_date"]`).attr(`content`));let o=[];return a(`meta[property="citation_author"]`).each(function(){o.push(a(this).attr(`content`))}),n.author=o.join(`, `),n.description=a(`div[itemprop="description"]`).html(),n})));return await c.close(),{title:`${d(`meta[property="profile:username"]`).attr(`content`)}'s Publications - ResearchGate`,link:s,item:p}}export{i as route};