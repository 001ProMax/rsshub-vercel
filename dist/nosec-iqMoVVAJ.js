import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import{ofetch_default as e}from"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{got_default as t}from"./got-BwctkUCD.js";import{load as n}from"cheerio";const r=`https://nosec.org/home/ajaxindexdata`,i={threaten:`威胁情报`,security:`安全动态`,hole:`漏洞预警`,leakage:`数据泄露`,speech:`专题报告`,skill:`技术分析`,tool:`安全工具`},a={path:`/:keykind?`,categories:[`programming`],example:`/nosec/hole`,parameters:{keykind:`对应文章分类`},name:`Posts`,maintainers:[`hellodword`],description:"| 分类     | 标识       |\n| :------- | :--------- |\n| 威胁情报 | `threaten` |\n| 安全动态 | `security` |\n| 漏洞预警 | `hole`     |\n| 数据泄露 | `leakage`  |\n| 专题报告 | `speech`   |\n| 技术分析 | `skill`    |\n| 安全工具 | `tool`     |",handler:o,radar:[{source:[`nosec.org/home/index/:keykind`,`nosec.org/home/index`],target:e=>`/nosec${e.keykind?`/${e.keybind.replace(`.html`,``)}`:``}`}]};async function o(a){let o=await e.raw(`https://nosec.org/home/index`),s=n(o._data),c=s(`meta[name="csrf-token"]`).attr(`content`),l=o.headers.getSetCookie().toString(),u=l.match(/XSRF-TOKEN=[^\s;]+/)[0],d=l.match(/laravel_session[^\s;]+/)[0],f=a.req.param(`keykind`)||``,p,m,h;Object.hasOwn(i,f)?(p=`keykind=${f}&page=1`,m=`NOSEC 安全讯息平台 - ${i[f]}`,h=`https://nosec.org/home/index/${f}.html`):(p=`keykind=&page=1`,m=`NOSEC 安全讯息平台`,h=`https://nosec.org/home/index`);let g=await t({method:`post`,url:r,headers:{"Content-Type":`application/x-www-form-urlencoded; charset=UTF-8`,Accept:`application/json`,cookie:`${u};${d}`,"X-CSRF-TOKEN":c},body:p}),_=g.data.data.threatData.data;return{title:m,link:h,description:m,item:_.map(e=>({title:e.title,description:e.summary,pubDate:new Date(e.publiced_at).toUTCString(),link:`https://nosec.org/home/detail/${e.id}.html`,author:e.username}))}}export{a as route};