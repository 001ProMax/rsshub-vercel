import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";import{load as r}from"cheerio";const i=async i=>{let a=i.req.query(`limit`)?Number.parseInt(i.req.query(`limit`),10):10,o=`http://chinacustoms.gmcmonline.com`,s=`http://manager.gmcmonline.com`,{data:c}=await n(o),l=r(c),u=l(`p.copyright a`).text(),d=l(`html`).prop(`lang`),f=l(`ul.booklist li a`).toArray().slice(0,a).map(e=>{e=l(e);let n=e.find(`p.txt`).text(),r=new URL(e.find(`img`).prop(`src`),o).href;return{title:n,link:new URL(e.prop(`href`),o).href,pubDate:t(n,`YYYY年MM期`),author:u,image:r,banner:r,language:d}});f=await Promise.all(f.map(i=>e.tryGet(i.link,async()=>{let{data:e}=await n(i.link),a=r(e);a(`ol.breadcrumb li a`).first().remove();let c=a(`ol.breadcrumb li a`).first().text(),f=t(a(`div.title`).text(),`YYYY年MM月DD日`),p=new URL(a(`div.coverline img`).prop(`src`),o).href;return a(`a.txt`).toArray().map(e=>{e=l(e);let t=e.prop(`href`).match(/c\/(\d+)\.shtml/)?.[1]??void 0;if(!t)return;let n=e.prop(`title`)||e.text(),r=`gmcmonline-chinacustoms-${t}`;return{title:n,pubDate:f,link:new URL(e.prop(`href`),i.link).href,category:[c,e.closest(`div.class-box`).find(`div.title-box span`).text().replaceAll(/【|】/g,``)||void 0].filter(Boolean),author:u,guid:r,id:r,image:p,banner:p,language:d,enclosure_url:new URL(`front/article/${t}/pdf?magazineID=2`,s).href,enclosure_type:`application/pdf`,enclosure_title:n}}).filter(Boolean)})));let p=l(`title`).text(),m=new URL(l(`div.img-box img`).prop(`src`),o).href;return{title:p,description:p,link:o,item:f.flat(),allowEmpty:!0,image:m,author:p,language:d}},a={path:`/chinacustoms`,name:`中国海关`,url:`chinacustoms.gmcmonline.com`,maintainers:[`nczitzk`],handler:i,example:`/gmcmonline/chinacustoms`,parameters:void 0,description:void 0,categories:[`reading`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`chinacustoms.gmcmonline.com`],target:`/chinacustoms`}]};export{i as handler,a as route};