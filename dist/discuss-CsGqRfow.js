import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";import{timezone as r}from"./timezone-CCdTtC9I.js";import{load as i}from"cheerio";const a=`https://www.nowcoder.com`,o={path:`/discuss/:type/:order`,categories:[`bbs`],example:`/nowcoder/discuss/2/4`,parameters:{type:`讨论区分区id 在 URL 中可以找到`,order:`排序方式`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`讨论区`,maintainers:[`LogicJake`],handler:s,description:`| 最新回复 | 最新发表 | 最新 | 精华 |
| -------- | -------- | ---- | ---- |
| 0        | 3        | 1    | 4    |`};async function s(o){let s=o.req.param(`type`),c=o.req.param(`order`),l=`https://www.nowcoder.com/discuss?type=${s}&order=${c}`,u=await n.get(l),d=i(u.data),f=d(`a.discuss-tab.selected`).text(),p=d(`li.selected a`).text(),m=d(`li.clearfix`).map(function(){let e={title:d(this).find(`div.discuss-main.clearfix a:first`).text().trim().replace(`
`,` `),link:d(this).find(`div.discuss-main.clearfix a[rel]`).attr(`href`)};return e}).get(),h=await Promise.all(m.map(o=>{let s=o.title||`tzgg`,c=new URL(o.link,a).href.replace(/^(.*)\?(.*)$/,`$1`);return e.tryGet(c,async()=>{let e=await n.get(c),a=i(e.data),o=a(`span.post-time`).text(),l=a(`.nc-post-content`).html();return{title:s,link:c,description:l,pubDate:r(t(o),8)}})}));return{title:`${f}${p}——牛客网讨论区`,link:l,item:h}}export{o as route};