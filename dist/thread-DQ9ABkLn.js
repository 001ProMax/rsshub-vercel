import"./esm-shims-CtP6w_ML.js";import{config as e}from"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";import{timezone as r}from"./timezone-CCdTtC9I.js";import{load as i}from"cheerio";import a from"query-string";const o={path:`/thread/:tid`,categories:[`bbs`],example:`/saraba1st/thread/1842868`,parameters:{tid:`帖子 id`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`帖子`,maintainers:[`zengxs`],handler:s,description:"帖子网址如果为 `https://bbs.saraba1st.com/2b/thread-1842868-1-1.html` 那么帖子 id 就是 `1789863`。"};async function s(o){let s=o.req.param(`tid`),c=e.saraba1st.cookie??``,l=await n(`https://bbs.saraba1st.com/2b/forum.php`,{searchParams:a.stringify({mod:`viewthread`,tid:s,ordertype:1}),headers:{Cookie:c}}),u=i(l.data),d=u(`#thread_subject`).text(),f=u(`#postlist > div[id^=post_]:not(:first-of-type)`),p=[];for(let e=0;e<Math.min(f.length,20);e++)p.push(e);let m=p.map(e=>{let n=u(f[e]),i=n.find(`td.plc .pi a > em`).text(),a=n.find(`td.plc .pi a`).attr(`href`),o=u(n.find(`td.t_f`)),s=o.find(`img`);for(let e of s)if(e.attribs.src===`https://static.saraba1st.com/image/common/none.gif`){e.attribs.src=e.attribs.file;let t=u(e);t.removeAttr(`zoomfile`),t.removeAttr(`file`),t.removeAttr(`onmouseover`),t.removeAttr(`onclick`)}return o.find(`div.aimg_tip`).remove(),{title:`${d} #${i}`,link:new URL(a,`https://bbs.saraba1st.com/2b/`).href,description:o.html(),author:n.find(`.authi .xw1`).text(),pubDate:r(t(n.find(`.authi em`).text()),8)}});return{title:`Stage1 论坛 - ${d}`,link:`https://bbs.saraba1st.com/2b/thread-${s}-1-1.html`,item:m}}export{o as route};