import{config as e}from"./config-DYqAlsU3.js";import{logger_default as t}from"./logger-BlLSmUdl.js";import{proxy_default as n}from"./proxy-kot7LoOQ.js";import r from"puppeteer";import i from"proxy-chain";import{addExtra as a}from"puppeteer-extra";import o from"puppeteer-extra-plugin-stealth";const s={args:[`--no-sandbox`,`--disable-setuid-sandbox`,`--disable-infobars`,`--window-position=0,0`,`--ignore-certificate-errors`,`--ignore-certificate-errors-spki-list`,`--user-agent=${e.ua}`],headless:!0,ignoreHTTPSErrors:!0},c=async(c={})=>{let l=r;c.stealth&&(l=a(r),l.use(o())),n.proxyUri&&(n.proxyUrlHandler?.username||n.proxyUrlHandler?.password?n.proxyUrlHandler.protocol===`http:`?s.args.push(`--proxy-server=${await i.anonymizeProxy(n.proxyUri)}`):t.warn(`SOCKS/HTTPS proxy with authentication is not supported by puppeteer, continue without proxy`):s.args.push(`--proxy-server=${n.proxyUri.replace(`socks5h://`,`socks5://`).replace(`socks4a://`,`socks4://`)}`));let u=await(e.puppeteerWSEndpoint?l.connect({browserWSEndpoint:e.puppeteerWSEndpoint}):l.launch(e.chromiumExecutablePath?{executablePath:e.chromiumExecutablePath,...s}:s));return setTimeout(async()=>{await u.close()},3e4),u};var l=c;export{l as puppeteer_default};