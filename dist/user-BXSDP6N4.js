import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./proxy-kot7LoOQ.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";import"./puppeteer-DQCLzTv0.js";import"./puppeteer-utils-DKJNO2_A.js";import{parseToken as r}from"./cookies-CVZriR-i.js";import i from"sanitize-html";import a from"query-string";const o=`https://xueqiu.com`,s={path:`/user/:id/:type?`,categories:[`finance`],example:`/xueqiu/user/8152922548`,parameters:{id:`用户 id, 可在用户主页 URL 中找到`,type:`动态的类型, 不填则默认全部`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`xueqiu.com/u/:id`],target:`/user/:id`}],name:`用户动态`,maintainers:[`imlonghao`],handler:c,description:`| 原发布 | 长文 | 问答 | 热门 | 交易 |
| ------ | ---- | ---- | ---- | ---- |
| 0      | 2    | 4    | 9    | 11   |`};async function c(s){let c=s.req.param(`id`),l=s.req.param(`type`)||10,u=l===`11`?`买卖`:``,d={10:`全部`,0:`原发布`,2:`长文`,4:`问答`,9:`热门`,11:`交易`},f=`${o}/u/${c}`,p=await r(f),m=await n({method:`get`,url:`${o}/v4/statuses/user_timeline.json`,searchParams:a.stringify({user_id:c,type:l,source:u}),headers:{Cookie:p,Referer:f}}),h=m.data.statuses.filter(e=>e.mark!==1),g=await Promise.all(h.map(r=>e.tryGet(r.target,async()=>{let e=await n({method:`get`,url:o+r.target,headers:{Referer:f,Cookie:p}}),a=JSON.parse(e.data.match(/SNOWMAN_STATUS = (.*?});/)[1]);r.text=a.text;let s=r.retweeted_status?`<blockquote>${r.retweeted_status.user.screen_name}:&nbsp;${r.retweeted_status.description}</blockquote>`:``,c=r.description+s;return{title:r.title||i(c,{allowedTags:[],allowedAttributes:{}}),description:r.text?r.text+s:c,pubDate:t(r.created_at),link:o+r.target}})));return{title:`${h[0].user.screen_name} 的雪球${d[l]}动态`,link:f,description:`${h[0].user.screen_name} 的雪球${d[l]}动态`,item:g}}export{s as route};