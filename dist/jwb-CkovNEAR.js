import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{got_default as n}from"./got-BwctkUCD.js";import{load as r}from"cheerio";const i=`https://jwb.shu.edu.cn/`,a=new Map([[`notice`,`tzgg`],[`news`,`xw`]]),o={path:[`/jwb/:type?`],radar:[{source:[`www.shu.edu.cn/index`],target:`/:type?`}],name:`教务部`,maintainers:[`tuxinghuan`,`GhhG123`],handler:s,description:`| 通知通告 | 新闻 | 政策文件(bug) |
| -------- | ---- | -------- |
| notice   | news | policy   |`};async function s(o){let s=o.req.param(`type`)||`notice`,c=`https://jwb.shu.edu.cn/index/${a.get(s)||s}.htm`,l=await n.get(c),u=r(l.data),d=u(`title`).text(),f=u(`.only-list`).find(`li`).slice(0,10).toArray().map(e=>({title:u(e).find(`a`).text(),link:new URL(u(e).find(`a`).attr(`href`),i).href,date:u(e).children(`span`).text()})),p=await Promise.all(f.map(i=>e.tryGet(i.link,async()=>{let e=await n.get(i.link),a=r(e.data);return i.author=a(`[id$=_lblUser]`).text().trim(),i.pubDate=t(i.date,`YYYY年MM月DD日`),i.description=a(`.v_news_content`).html()||i.title,i})));return{title:d,link:c,image:`https://www.shu.edu.cn/__local/0/08/C6/1EABE492B0CF228A5564D6E6ABE_779D1EE3_5BF7.png`,item:p}}export{o as route};