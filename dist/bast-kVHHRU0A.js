import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{getSubPath as n}from"./common-utils-C27Jp3s6.js";import{got_default as r}from"./got-BwctkUCD.js";import{timezone as i}from"./timezone-CCdTtC9I.js";import{load as a}from"cheerio";const o={path:`*`,name:`Unknown`,maintainers:[],handler:s};async function s(o){let s=n(o).replace(/^\//,``)||`32942`,c=o.req.query(`limit`)?Number.parseInt(o.req.query(`limit`)):50,l=`https://www.bast.net.cn`,u=`${l}/${isNaN(s)?s:`col/col${s}`}/`,d=await r({method:`get`,url:u}),f=a(d.data);f(`.list-title-bif`).remove();let p=f(`title`).text(),m=f(`a[title]`);m.length===0&&(f=a(f(`ul.cont-list div script`).first().text()),f(`.list-title-bif`).remove(),m=f(`a[title]`));let h=m.slice(0,c).toArray().map(e=>(e=f(e),{title:e.text().trim(),link:e.attr(`href`)}));return h=await Promise.all(h.map(n=>e.tryGet(n.link,async()=>{if(/bast\.net\.cn/.test(n.link)){let e=await r({method:`get`,url:n.link}),o=a(e.data);n.title=o(`meta[name="ArticleTitle"]`).attr(`content`),n.author=o(`meta[name="contentSource"]`).attr(`content`),n.pubDate=i(t(o(`meta[name="pubdate"]`).attr(`content`)),8),n.category=[o(`meta[name="ColumnName"]`).attr(`content`)],n.description=o(`.arccont`).html()}return n}))),{title:p,link:u,item:h}}export{o as route};