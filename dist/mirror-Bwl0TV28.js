import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{parseDate as e}from"./parse-date-DHsdom8D.js";import{got_default as t}from"./got-BwctkUCD.js";import{invalid_parameter_default as n}from"./invalid-parameter-CvwVNf6G.js";import{isValidHost as r}from"./valid-host-BNlvoFtX.js";import i from"markdown-it";const a=i({html:!0,linkify:!0}),o={path:`/:id`,categories:[`new-media`,`popular`],example:`/mirror/tingfei.eth`,parameters:{id:`user id`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`User`,maintainers:[`fifteen42`,`rde9`,`nczitzk`],handler:s};async function s(i){let o=i.req.param(`id`);if(!o.endsWith(`.eth`)&&!r(o))throw new n(`Invalid id`);let s=`https://mirror.xyz`,c=o.endsWith(`.eth`)?`${s}/${o}`:`https://${o}.mirror.xyz`,l=await t(c),u=JSON.parse(l.data.match(/"__NEXT_DATA__" type="application\/json">({"props":.*})<\/script>/)[1]),d=Object.keys(u.props.pageProps.__APOLLO_STATE__).filter(e=>e.startsWith(`entry:`)).map(t=>{let n=u.props.pageProps.__APOLLO_STATE__[t];return{title:n.title,description:a.render(n.body),link:`${c}/${n._id}`,pubDate:e(n.publishedAtTimestamp,`X`),author:u.props.pageProps.publicationLayoutProject.displayName}});return{title:`${u.props.pageProps.publicationLayoutProject.displayName} - Mirror`,description:u.props.pageProps.publicationLayoutProject.description,image:u.props.pageProps.publicationLayoutProject.avatarURL,link:c,item:d}}export{o as route};