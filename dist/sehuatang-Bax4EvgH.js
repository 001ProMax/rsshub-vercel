import"./config-DYqAlsU3.js";import{logger_default as e}from"./logger-BlLSmUdl.js";import"./proxy-kot7LoOQ.js";import{cache_default as t}from"./cache-CvppK6AM.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{timezone as r}from"./timezone-CCdTtC9I.js";import{puppeteer_default as i}from"./puppeteer-DQCLzTv0.js";import{load as a}from"cheerio";const o=`https://www.sehuatang.net/`,s={gcyc:`2`,yzwmyc:`36`,yzymyc:`37`,gqzwzm:`103`,sjxz:`107`,vr:`160`,srym:`104`,omwm:`38`,"4k":`151`,hgzb:`152`,dmyc:`39`,yczp:`155`,ztzp:`125`,hrjp:`50`,yzxa:`48`,omxa:`49`,ktdm:`117`,ttxz:`165`,zhtl:`95`,mrhj:`106`,ai:`113`,ydsc:`111`,hrxazp:`98`},c={path:[`/bt/:subforumid?`,`/picture/:subforumid`,`/:subforumid?/:type?`,`/:subforumid?`,``],name:`Forum`,maintainers:[`qiwihui`,`junfengP`,`nczitzk`],features:{requirePuppeteer:!0},handler:l,description:`**原创 BT 电影**

| 国产原创 | 亚洲无码原创 | 亚洲有码原创 | 高清中文字幕 | 三级写真 | VR 视频 | 素人有码 | 欧美无码 | 韩国主播 | 动漫原创 | 综合讨论 |
| -------- | ------------ | ------------ | ------------ | -------- | ------- | -------- | -------- | -------- | -------- | -------- |
| gcyc     | yzwmyc       | yzymyc       | gqzwzm       | sjxz     | vr      | srym     | omwm     | hgzb     | dmyc     | zhtl     |

  **色花图片**

| 原创自拍 | 转贴自拍 | 华人街拍 | 亚洲性爱 | 欧美性爱 | 卡通动漫 | 套图下载 |
| -------- | -------- | -------- | -------- | -------- | -------- | -------- |
| yczp     | ztzp     | hrjp     | yzxa     | omxa     | ktdm     | ttxz     |`};async function l(c){let l=c.req.param(`subforumid`)??`gqzwzm`,u=l in s?s[l]:l,d=c.req.param(`type`),f=d?`&filter=typeid&typeid=${d}`:``,p=`${o}forum.php?mod=forumdisplay&orderby=dateline&fid=${u}${f}`,m=await i(),h=await m.newPage();await h.setRequestInterception(!0),h.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),e.http(`Requesting ${p}`),await h.goto(p,{waitUntil:`domcontentloaded`}),await h.waitForSelector(`a.enter-btn`,{visible:!0}),await Promise.all([h.click(`a.enter-btn`),h.waitForNavigation({waitUntil:`domcontentloaded`})]);let g=await h.content();await h.close();let _=a(g),v=_(`#threadlisttableid tbody[id^=normalthread]`).slice(0,c.req.query(`limit`)?Number.parseInt(c.req.query(`limit`)):25).toArray().map(e=>{e=_(e);let t=e.find(`th em a`).length;return{title:`${t?`[${e.find(`th em a`).text()}]`:``} ${e.find(`a.xst`).text()}`,link:o+e.find(`a.xst`).attr(`href`),pubDate:n(e.find(`td.by`).find(`em span span`).attr(`title`)),author:e.find(`td.by cite a`).first().text()}}),y=await Promise.all(v.map(e=>t.tryGet(e.link,async()=>{let t=await m.newPage();await t.setRequestInterception(!0),t.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),await t.goto(e.link,{waitUntil:`domcontentloaded`});let i=await t.content();await t.close();let s=a(i),c=s(`td[id^='postmessage']`).slice(0,1),l=s(c).find(`img`);for(let e of l){let t=s(e).attr(`file`);!t||t===`undefined`?s(e).replaceWith(``):s(e).replaceWith(s(`<img src="${t}">`))}let u=s(`.pattl`),d=s(u).find(`img`);for(let e of d){let t=s(e).attr(`file`);!t||t===`undefined`?s(e).replaceWith(``):s(e).replaceWith(s(`<img src="${t}" />`))}c.append(s(u)),s(`em[onclick]`).remove(),e.description=(c.html()||`抓取原帖失败`).replaceAll(`ignore_js_op`,`div`),e.pubDate=r(n(s(`.authi em span`).attr(`title`)),8);let f=c.find(`div.blockcode li`).first().text(),p=f.startsWith(`magnet`),h=c.find(`p.attnm a`).attr(`href`),g=p||h!==void 0;if(g){let t=p?f:new URL(h,o).href;e.enclosure_url=t,e.enclosure_type=p?`application/x-bittorrent`:`application/octet-stream`}return e})));return await m.close(),{title:`色花堂 - ${_(`#pt > div:nth-child(1) > a:last-child`).text()}`,link:p,item:y}}export{c as route};