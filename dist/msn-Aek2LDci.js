import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import{ofetch_default as e}from"./ofetch-CWQqZcqz.js";import{cache_default as t}from"./cache-CvppK6AM.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{load as r}from"cheerio";const i=`0QfOX3Vn51YCzitbLaRkTTBadtWpgTN8NZLW0C1SEM`,a=/<img data-reference="image" data-document-id="cms\/api\/amp\/image\/([A-Za-z0-9]+)">/,o={path:`/:market/:name/:id`,parameters:{market:`Market code. Find it in MSN url, e.g. zh-tw`,name:`Name of the channel. Find it in MSN url, e.g. Bloomberg`,id:`ID of the channel (always starts with sr-vid). Find it in MSN url, e.g. sr-vid-08gw7ky4u229xjsjvnf4n6n7v67gxm0pjmv9fr4y2x9jjmwcri4s`},categories:[`traditional-media`],example:`/zh-tw/Bloomberg/sr-vid-08gw7ky4u229xjsjvnf4n6n7v67gxm0pjmv9fr4y2x9jjmwcri4s`,description:`MSN News`,features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0},radar:[{source:[`www.msn.com/:market/channel/source/:name/:id`],target:`/:market/:name/:id`}],name:`News`,maintainers:[`KTachibanaM`],handler:async o=>{let{market:s,name:c,id:l}=o.req.param(),u=l;u.startsWith(`sr-`)&&(u=u.substring(3));let d=await e(`https://www.msn.com/${s}/channel/source/${c}/${l}`),f=r(d),p=f(`head`),m=p.attr(`data-client-settings`)??`{}`,h=JSON.parse(m),g=h.fd_muid,_=await e(`https://assets.msn.com/service/news/feed/pages/providerfullpage?market=${s}&query=newest&CommunityProfileId=${u}&apikey=${i}&user=m-${g}`),v=await Promise.all(_.sections[0].cards.map(async r=>{let i=``,o=r.url,c=URL.parse(o),l=c?.pathname.split(`/`).pop();if(l?.startsWith(`ar-`)){l=l.substring(3);let n=await t.tryGet(l,async()=>{let t=await e(`https://assets.msn.com/content/view/v2/Detail/${s}/${l}`);return t.body});i=n.replace(a,`<img src="https://img-s-msn-com.akamaized.net/tenant/amp/entityid/$1.img">`)}return{title:r.title,link:o,description:r.abstract,content:{html:i},pubDate:n(r.publishedDateTime),category:[r.category]}})),y=`https://www.msn.com/${s}/channel/source/${c}/${l}`;return{title:c,image:`https://www.msn.com/favicon.ico`,link:y,item:v}}};export{o as route};