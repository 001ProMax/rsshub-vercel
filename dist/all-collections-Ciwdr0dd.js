import"./esm-shims-CtP6w_ML.js";import"./config-DYqAlsU3.js";import"./logger-BlLSmUdl.js";import"./ofetch-CWQqZcqz.js";import"./helpers-RrXnNmv1.js";import{cache_default as e}from"./cache-CvppK6AM.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./md5-BJqXla8f.js";import{got_default as n}from"./got-BwctkUCD.js";import{ViewType as r}from"./types-Bi82qguM.js";import{header as i}from"./utils-WD29XLhf.js";const a={path:`/people/allCollections/:id`,categories:[`social-media`],view:r.Articles,example:`/zhihu/people/allCollections/87-44-49-67`,parameters:{id:`作者 id，可在用户主页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.zhihu.com/people/:id`]}],name:`用户全部收藏内容`,maintainers:[`Healthyyue`],handler:o};async function o(r){let a=r.req.param(`id`),o=`https://api.zhihu.com/people/${a}/collections`,s=await n(o,{headers:{Referer:`https://www.zhihu.com/people/${a}/collections`}}),c=s.data.data,l=await Promise.all(c.map(async t=>{let r=await n(`https://www.zhihu.com/api/v4/collections/${t.id}/items?offset=0&limit=20`,{headers:{...i,Referer:`https://www.zhihu.com/collection/${t.id}`}}),{data:a,paging:{totals:o}}=r.data;if(o>20){let r=Array.from({length:Math.ceil(o/20)-1},(e,t)=>(t+1)*20),s=await Promise.all(r.map(r=>e.tryGet(`https://www.zhihu.com/api/v4/collections/${t.id}/items?offset=${r}&limit=20`,async()=>{let e=await n(`https://www.zhihu.com/api/v4/collections/${t.id}/items?offset=${r}&limit=20`,{headers:{...i,Referer:`https://www.zhihu.com/collection/${t.id}`}});return e.data.data})));a.push(...s.flat())}return{collectionId:t.id,collectionTitle:t.title,items:a}})),u=l.flatMap(e=>e.items.map(t=>({...t,collectionTitle:e.collectionTitle})));return{title:`${c[0].creator.name}的知乎收藏`,link:`https://www.zhihu.com/people/${a}/collections`,item:u.map(e=>{let n=e.content;return{title:n.type===`article`||n.type===`zvideo`?n.title:n.question.title,link:n.url,description:n.type===`zvideo`?`<img src=${n.video.url}/>`:n.content,pubDate:t((n.type===`article`?n.updated:n.updated_time)*1e3),category:[e.collectionTitle]}})}}export{a as route};