import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{ofetch_default as n}from"./ofetch-ZUQ1sEMc.js";const r={path:`/threads/:type?`,categories:[`bbs`],example:`/deepin/threads/latest`,parameters:{type:{description:`主题类型`,options:[{value:`hot`,label:`最热主题`},{value:`latest`,label:`最新主题`}]}},name:`首页主题列表`,maintainers:[`myml`],radar:[{source:[`bbs.deepin.org`],target:`/threads/latest`}],handler:a},i={hot:{where:`hot_value`,title:`最热主题`},latest:{where:`id`,title:`最新主题`}};async function a(r){let a=i.latest;r.req.param(`type`)===`hot`&&(a=i.hot);let o=await n(`https://bbs.deepin.org.cn/api/v1/thread/index`,{query:{languages:`zh_CN`,order:`updated_at`,where:a.where},headers:{accept:`application/json`}}),s=await Promise.all(o.ThreadIndex.map(r=>{let i=`https://bbs.deepin.org.cn/post/`+r.id;return t.tryGet(i,async()=>{let t={id:String(r.id),title:r.subject,link:i,pubDate:e(r.created_at),author:r.user.nickname,category:[r.forum.name],description:``},a=await n(`https://bbs.deepin.org.cn/api/v1/thread/info?id=`+t.id);if(a){let e=a;t.description=e.data.post.message}return t})}));return{title:`deepin论坛主页 - `+a.title,link:`https://bbs.deepin.org`,item:s}}export{r as route};