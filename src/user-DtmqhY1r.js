import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{ofetch_default as n}from"./ofetch-ZUQ1sEMc.js";import*as r from"cheerio";const i={path:`/user/:pphId`,categories:[`new-media`],example:`/thepaper/user/4221423`,parameters:{pphId:`澎湃号 id，可在澎湃号页 URL 中找到`},name:`澎湃号`,maintainers:[`TonyRL`],handler:a};async function a(i){let{pphId:a}=i.req.param(),o=await t.tryGet(`thepaper:m:buildId`,async()=>{let e=await n(`https://m.thepaper.cn`),t=r.load(e),i=JSON.parse(t(`script#__NEXT_DATA__`).text());return i.buildId}),s=await t.tryGet(`thepaper:user:${a}`,async()=>{let e=await n(`https://api.thepaper.cn/userservice/user/homePage/${a}`,{headers:{"Client-Type":`2`,Origin:`https://m.thepaper.cn`,Referer:`https://m.thepaper.cn/`}});return e.userInfo}),c=await n(`https://api.thepaper.cn/contentapi/cont/pph/user`,{method:`POST`,body:{pageSize:10,pageNum:1,contType:0,excludeContIds:[],pphId:a,startTime:0}}),l=c.data.list.map(t=>({title:t.name,link:`https://www.thepaper.cn/newsDetail_forward_${t.contId}`,pubDate:e(t.pubTimeLong),author:t.authorInfo.sname,contId:t.contId,image:t.pic})),u=await Promise.all(l.map(r=>t.tryGet(r.link,async()=>{let t=await n(`https://m.thepaper.cn/_next/data/${o}/detail/${r.contId}.json`,{query:{id:r.contId}});return r.description=t.pageProps.detailData.contentDetail.content,r.updated=e(t.pageProps.detailData.contentDetail.updateTime),r})));return{title:s.sname,description:s.perDesc,link:`https://www.thepaper.cn/user_${a}`,item:u,itunes_author:s.sname,image:s.pic}}export{i as route};