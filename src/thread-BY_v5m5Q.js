import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{art as r}from"./render-DOz85fGU.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as i}from"./got-CB83B8oA.js";import{countReplies as a,viewThread as o}from"./query-C8_ItzOc.js";import s from"node:path";t();const c={path:`/thread/:id`,radar:[{source:[`lkong.com/thread/:id`,`lkong.com/`]}],name:`Unknown`,maintainers:[`nczitzk`,`ma6254`],handler:l};async function l(t){let c=t.req.param(`id`),l=`https://www.lkong.com`,u=`https://api.lkong.com/api`,d=`${l}/thread/${c}`,f=await i({method:`post`,url:u,json:a(c)});if(f.data.errors)throw Error(f.data.errors[0].message);let p=await i({method:`post`,url:u,json:o(c,Math.ceil(f.data.data.thread.replies/20))}),m=p.data.data.posts.map(t=>({guid:t.pid,author:t.user.name,title:`#${t.lou} ${t.user.name}`,link:`${l}/thread/${c}?pid=${t.pid}`,pubDate:n(t.dateline),description:(t.quote?r(s.join(e,`templates/quote-0d63bb36.art`),{target:`${l}/thread/${c}?pid=${t.quote.pid}`,author:t.quote.author.name,content:r(s.join(e,`templates/content-b0aebebb.art`),{content:JSON.parse(t.quote.content)})}):``)+r(s.join(e,`templates/content-b0aebebb.art`),{content:JSON.parse(t.content)})}));return{title:`${p.data.data.thread.title} - 龙空`,link:d,item:m}}export{c as route};