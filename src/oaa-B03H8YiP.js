import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{finishArticleItem as i}from"./wechat-mp-Ckmb_xfa.js";import{load as a}from"cheerio";const o=`http://oaa.tju.edu.cn/`,s=`https://github.com/DIYgod/RSSHub/issues`,c=e=>{if(!e.startsWith(`http`))return`in-site`;let t=new URL(e);return t.hostname===`mp.weixin.qq.com`?`wechat-mp`:t.hostname===`oaa.tju.edu.cn`?`tju-oaa`:`unknown`},l={path:`/oaa/:type?`,categories:[`university`],example:`/tju/oaa/news`,parameters:{type:"default `news`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`The Office of Academic Affairs`,maintainers:[`AlanZeng423`,`AmosChenYQ`,`SuperPung`],handler:u,description:`| News | Notification |
| :--: | :----------: |
| news | notification |`};async function u(l){let u=l.req.param(`type`),d,f;switch(u){case`news`:f=`新闻动态`,d=`xwdt.htm`;break;case`notification`:f=`通知公告`,d=`tzgg.htm`;break;default:f=`新闻动态`,d=`xwdt.htm`}let p=null;try{p=await n(o+d,{headers:{Referer:o}})}catch{}if(p===null)return{title:`天津大学教务处 - `+f,link:o+d,description:`链接失效`+o+d,item:[{title:`提示信息`,link:s,description:`<h2>请到<a href=${s}>此处</a>提交Issue</h2>`}]};{let s=a(p.data),l=s(`.notice_l > ul > li > dl > dt`).toArray().map(t=>{let n=s(`a`,t).attr(`href`),i=c(n);return{title:s(`h2`,t).text(),link:i===`in-site`?o+n:n,pubDate:r(e(s(`.fl_01_r_time`,t).text(),`DDYYYY-MM`),8),type:i}}),u=await Promise.all(l.map(e=>{switch(e.type){case`wechat-mp`:return i(e);case`tju-oaa`:case`in-site`:return t.tryGet(e.link,async()=>{let t=null;try{t=await n(e.link,{https:{rejectUnauthorized:!1}});let r=a(t.data);e.description=r(`.v_news_content`).html()}catch{}return e});default:return e}}));return{title:`天津大学教务处 - `+f,link:o+d,description:null,item:u}}}export{l as route};