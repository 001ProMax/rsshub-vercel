import"./esm-shims-DtWyl6zt.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import"./dist-CKN2M7CD.js";import{cache_default as e}from"./cache-Sft5n2jg.js";import"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-CWsaZ4vY.js";import{baseUrl as n,getItem as r}from"./utils-BZsstuHj.js";import*as i from"cheerio";const a={path:`/magazine/:magazine`,categories:[`traditional-media`],example:`/qstheory/magazine/qs`,parameters:{magazine:"刊物，`qs` 为求是，`hqwglist` 为红旗文稿"},radar:[{source:[`www.qstheory.cn/:magazine/mulu.htm`]}],name:`在线读刊`,maintainers:[`TonyRL`,`cscnk52`],handler:o};async function o(a){let{magazine:o}=a.req.param(),s=`${n}/${o}/mulu.htm`,c=await t(s),l=i.load(c),u=l(`.booktitle a`).toArray().map(e=>{let t=l(e);return{title:t.text(),link:new URL(t.attr(`href`),n).href}}),d=await t(u[0].link),f=i.load(d),p=f(`.highlight a`).toArray().map(e=>{let t=f(e);return{title:t.text(),link:t.attr(`href`)}}).toReversed().filter(e=>e.title),m=await Promise.all(p.map(t=>e.tryGet(t.link,()=>r(t))));return{title:l(`head title`).text(),link:s,image:new URL(l(`.book img`).attr(`src`),s).href,item:m}}export{a as route};