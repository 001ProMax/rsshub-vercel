import{parseDate as e}from"./parse-date-D4osZfpm.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{got_default as n}from"./got-CB83B8oA.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{fetchArticle as i}from"./wechat-mp-Ckmb_xfa.js";import{load as a}from"cheerio";const o=e=>{if(!e.startsWith(`http`))return`in-nua`;let t=new URL(e);return t.hostname===`mp.weixin.qq.com`?`wechat-mp`:t.hostname===`www.nua.edu.cn`?`nua`:`unknown`};function s(e,t){return`<a href="${t}">${e}</a>`}async function c(t,i,s,c,l){let u=await n(t,{https:{rejectUnauthorized:!1}}),d=a(u.data),f=d(l).text().trim(),p=d(s).toArray().map(t=>{let n=d(t).find(`a`).attr(`href`),a=o(n);return{link:a===`in-nua`?i+n:n,title:d(t).find(`a`).attr(`title`),pubDate:r(e(d(t).find(c).first().text(),`YYYY-MM-DD`),8),type:a}});return[p,f]}const l=(e,r)=>Promise.all(e.map(e=>t.tryGet(e.link,async()=>{switch(e.type){case`in-nua`:case`nua`:{let t=await n(e.link,{https:{rejectUnauthorized:!1}}),i=a(t.data);return e.author=i(`.arti_publisher`).text()+`  `+i(`.arti_views`).text(),e.description=i(r).html(),e}case`wechat-mp`:return i(e.link);case`unknown`:default:return e.description=`暂不支持解析该内容，请点击 ${s(`原文`,e.link)}`,e}})));var u={ProcessList:c,ProcessFeed:l};export{u as utils_default};