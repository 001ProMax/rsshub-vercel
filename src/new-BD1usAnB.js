import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as r}from"./cache-GwMhal7i.js";import{art as i}from"./render-DOz85fGU.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as a}from"./got-CB83B8oA.js";import o from"node:path";import{load as s}from"cheerio";import c from"iconv-lite";t();const l={path:`/new`,categories:[`blog`],example:`/xys/new`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`xys.org/`,`xys.org/new.html`]}],name:`新到资料`,maintainers:[`wenzhenl`],handler:u,url:`xys.org/`};async function u(t){let l=`http://www.xys.org`,u=`${l}/new.html`,d=await a({method:`get`,url:u,responseType:`buffer`}),f=c.decode(d.data,`gb2312`),p=s(f),m=p(`li a`).slice(4,t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):30).toArray().map(e=>{e=p(e);let t=e.attr(`href`);/^https?:\/\//.test(t)||(t=l+`/`+t.replace(/^\//,``));let r=e.parent().text().trim().slice(0,8);return r=n(r,`YY.MM.DD`),{title:e.text(),link:t,pubDate:r}});return m=await Promise.all(m.filter(e=>!e.link.endsWith(`.zip`)).map(t=>r.tryGet(t.link,async()=>{let n=/(?:https?:\/\/)?(?:www\.)?youtu\.?be(?:\.com)?\/?.*(?:watch|embed)?(?:.*v=|v\/|\/)([\w-]+)&?/g,r=t.link.match(n);if(r)t.description=i(o.join(e,`templates/desc-2f9d87ea.art`),{youTube:t.link.slice(32)});else{let e=await a({method:`get`,url:t.link,responseType:`buffer`}),n=c.decode(e.data,`gb2312`),r=s(n);t.description=r.text().replaceAll(`
`,`<br>
`)}return t}))),{title:`新语丝 - 新到资料`,link:u,item:m}}export{l as route};