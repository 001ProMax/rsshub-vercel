import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./md5-4BNsOP-F.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{getSignedHeader as r,header as i,processImage as a}from"./utils-Dwi2apWv.js";const o={path:`/topic/:topicId/:isTop?`,categories:[`social-media`],example:`/zhihu/topic/19828946`,parameters:{topicId:`话题 id`,isTop:`仅精华，默认为否，其他值为是`},features:{requireConfig:[{name:`ZHIHU_COOKIES`,description:``}],requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.zhihu.com/topic/:topicId/:type`],target:`/topic/:topicId`}],name:`话题`,maintainers:[`xyqfer`],handler:s};async function s(o){let{topicId:s,isTop:c=!1}=o.req.param(),l=`https://www.zhihu.com/topic/${s}/${c?`top-answers`:`newest`}`,u=await t.tryGet(`zhihu:topic:${s}`,async()=>{let e=`https://www.zhihu.com/topic/${s}`,t=`/api/v4/topics/${s}/intro?include=content.meta.content.photos`,i=await r(e,t),{data:a}=await n(`https://www.zhihu.com`+t,{headers:i});return a}),d=`/api/v5.1/topics/${s}/feeds/${c?`top_activity`:`timeline_activity`}`,f=await r(l,d),{data:p}=await n(`https://www.zhihu.com${d}`,{headers:{...i,...f,Referer:l}}),m=p.data.map(({target:t})=>{let n=t.type,r=``,i=``,o=``,s,c=``;switch(n){case`answer`:r=`${t.question.title}-${t.author.name}的回答：${t.excerpt}`,i=`<strong>${t.question.title}</strong><br>${t.author.name}的回答<br/>${a(t.content)}`,o=`https://www.zhihu.com/question/${t.question.id}/answer/${t.id}`,s=e(t.updated_time*1e3),c=t.author.name;break;case`question`:r=t.title,i=t.title,o=`https://www.zhihu.com/question/${t.id}`,s=e(t.created*1e3);break;case`article`:r=t.title,i=a(t.content),o=t.url,s=e(t.created*1e3);break;case`zvideo`:r=t.title,i=`${t.description}<br>
                <video controls poster="${t.video.thumbnail}" preload="metadata">
                    <source src="${t.video.playlist.fhd?.url??t.video.playlist.hd?.url??t.video.playlist.ld?.url??t.video.playlist.sd?.url}" type="video/mp4">
                </video>`,o=t.url,s=e(t.created_at*1e3);break;default:i=`未知类型，请点击<a href="https://github.com/DIYgod/RSSHub/issues">链接</a>提交issue`,s=e(Date.now())}return{title:r,description:i,author:c,pubDate:s,guid:t.id.toString(),link:o}});return{title:`知乎话题-${s}-${c?`精华`:`讨论`}`,description:u.content.introduction,link:l,item:m}}export{o as route};