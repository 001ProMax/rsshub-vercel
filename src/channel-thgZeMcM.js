import{__dirname as e,init_esm_shims as t}from"./esm-shims-DtWyl6zt.js";import{config as n}from"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import"./dist-CKN2M7CD.js";import"./cache-Sft5n2jg.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-CWsaZ4vY.js";import{config_not_found_default as a}from"./config-not-found-BVqhRP9D.js";import{baseUrl as o,getChannel as s,getChannelMessages as c,getGuild as l}from"./discord-api-u8_190T8.js";import u from"node:path";t();const d={path:`/channel/:channelId`,categories:[`social-media`],example:`/discord/channel/950465850056536084`,parameters:{channelId:`Channel ID`},features:{requireConfig:[{name:`DISCORD_AUTHORIZATION`,description:`Discord authorization header from the browser`}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`discord.com/channels/:guildId/:channelId/:messageID`,`discord.com/channels/:guildId/:channelId`]}],name:`Channel Messages`,maintainers:[`TonyRL`],handler:f};async function f(t){if(!n.discord||!n.discord.authorization)throw new a(`Discord RSS is disabled due to the lack of <a href="https://docs.rsshub.app/deploy/config#route-specific-configurations">relevant config</a>`);let{authorization:d}=n.discord,f=t.req.param(`channelId`),p=await s(f,d),m=await c(f,d,t.req.query(`limit`)??100),{name:h,topic:g,guild_id:_}=p,v=await l(_,d),{name:y,icon:b}=v,x=m.map(t=>({title:t.content.split(`
`)[0],description:r(u.join(e,`templates/message-311bc85b.art`),{message:t,guildInfo:v}),author:`${t.author.global_name??t.author.username}(${t.author.username})`,pubDate:i(t.timestamp),updated:t.edited_timestamp?i(t.edited_timestamp):void 0,category:`#${h}`,link:`${o}/channels/${_}/${f}/${t.id}`}));return{title:`#${h} - ${y} - Discord`,description:g,link:`${o}/channels/${_}/${f}`,image:`https://cdn.discordapp.com/icons/${_}/${b}.webp`,item:x,allowEmpty:!0}}export{d as route};