import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as r}from"./cache-GwMhal7i.js";import{art as i}from"./render-DOz85fGU.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as a}from"./got-CB83B8oA.js";import o from"node:path";t();const s={path:`/:category?/:section?`,categories:[`traditional-media`],example:`/straitstimes/singapore`,parameters:{category:`Category, see below for more information`,section:`Section, see below for more information`},features:{requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1,requireConfig:!1},name:`News`,maintainers:[`quiniapiezoelectricity`],handler:c,description:"\n| Category               | `:category`               |\n| ---------------------- | --------------------------- |\n| Singapore              | `singapore`               |\n| Asia                   | `asia`                    |\n| World                  | `world`                   |\n| Opinion                | `opinion`                 |\n| Life                   | `life`                    |\n| Business               | `business`                |\n| Jobs                   | `jobs`                    |\n| Parenting & Education  | `parenting-and-education` |\n| Food                   | `food`                    |\n| Tech                   | `tech`                    |\n| Sport                  | `sport`                   |\n| Podcasts               | `podcasts`                |,\n\n| Section                | `:section`                |\n| ---------------------- | --------------------------- |\n| Top Stories            | `top-stories`             |\n| Latest                 | `latest`                  |",radar:[{source:[`www.straitstimes.com/:category`],target:`/:category`},{source:[`www.straitstimes.com`],target:`/`}]};async function c(t){let s=t.req.param(`category`)?t.req.param(`category`).toLowerCase():`singapore`,c=t.req.param(`section`)?t.req.param(`section`).toLowerCase():void 0,l=`T9XUJM9rAZoLOd2CAx2wCBSTrm3xoyPw`,u=`iosflex`,d,f=await a({method:`get`,url:`https://newsapi.sphdigital.com/v2/feed/section/st?page=1&platform=${u}&section=${s}/star&subscribed=false&version=4.0`,headers:{"x-api-key":l}});d=f.data.data;let p=new Set(d.filter(e=>e.items[0].itemType===`SectionFooter`).map(e=>e.items[0].sectionFooterData.link.id)),m=c&&p.has(`${s}-${c}-more/star`)?`${s}-${c}-more/star`:void 0;if(c===void 0){for(let e of[`latest`,`top-picks`,`top-stories`])if(p.has(`${s}-${e}-more/star`)){m=`${s}-${e}-more/star`;break}}if(m){let e=await a({method:`get`,url:`https://newsapi.sphdigital.com/v2/feed/section/st?page=1&platform=${u}&section=${m}&subscribed=false&version=4.0`,headers:{"x-api-key":l}});d=e.data.data}let h=d.filter(e=>e.items[0].itemType===`Article`),g=await Promise.all(h.map(t=>r.tryGet(t.items[0].articleData.url,async()=>{let r=t.items[0].articleData;r.authors&&(t.author=r.authors.map(e=>e.name).join(`, `)),r.keywords&&(t.category=r.keywords.map(e=>e.name)),t.title=r.headline,t.pubDate=n(r.publicationTime,`X`),t.updated=n(r.updatedTime,`X`),t.link=r.url;let s=r.teaser;if(r.documentId){let e=await a({method:`get`,url:`https://newsapi.sphdigital.com/v2/feed/article/st/${r.documentId}?platform=${u}&version=4.0`,headers:{"x-api-key":l}});s=e.data.data.body}return t.description=i(o.join(e,`templates/description-38cf9443.art`),{images:r.images??[],article:s}),t})));return{title:`The Strait Times - ${s.replaceAll(`-`,` `).toUpperCase()}`,link:`https://www.straitstimes.com/${s.toLowerCase()}`,item:g}}export{s as route};