import"./esm-shims-CGUM9TC6.js";import{config as e}from"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as t}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as n}from"./cache-GwMhal7i.js";import"./md5-4BNsOP-F.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as r}from"./got-CB83B8oA.js";import{header as i}from"./utils-gEzI6hV3.js";import{generateData as a}from"./utils-DgzsJhkV.js";import{load as o}from"cheerio";const s={path:`/collection/:id/:getAll?`,categories:[`social-media`],example:`/zhihu/collection/26444956`,parameters:{id:`收藏夹 id，可在收藏夹页面 URL 中找到`,getAll:`获取全部收藏内容，任意值为打开`},features:{requireConfig:[{name:`ZHIHU_COOKIES`,description:``}],requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.zhihu.com/collection/:id`],target:`/collection/:id`}],name:`收藏夹`,maintainers:[`huruji`,`Colin-XKL`,`Fatpandac`],handler:c};async function c(s){let c=s.req.param(`id`),l=s.req.param(`getAll`),u=await r({method:`get`,url:`https://www.zhihu.com/api/v4/collections/${c}/items?offset=0&limit=20`,headers:{...i,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${c}`}}),d=u.data.data;if(l){let t=u.data.paging.totals,a=[...Array.from({length:Math.round(t/20)}).keys()].map(e=>e*20).slice(1),o=await Promise.all(a.map(t=>n.tryGet(`https://www.zhihu.com/api/v4/collections/${c}/items?offset=${t}&limit=20`,async()=>{let n=await r({method:`get`,url:`https://www.zhihu.com/api/v4/collections/${c}/items?offset=${t}&limit=20`,headers:{...i,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${c}`}});return n.data.data}))).then(e=>e.flat());d.push(...o)}let f=await r({method:`get`,url:`https://www.zhihu.com/collection/${c}`,headers:{...i,Referer:`https://www.zhihu.com/collection/${c}`}}),p=f.data,m=o(p),h=m(`.CollectionDetailPageHeader-title`).text()+` - 知乎收藏夹`,g=m(`.CollectionDetailPageHeader-description`).text(),_=e=>a([e.content])[0];return{title:h,link:`https://www.zhihu.com/collection/${c}`,description:g,item:d&&d.map(e=>e.content.type===`pin`?_(e):{title:e.content.type===`article`||e.content.type===`zvideo`?e.content.title:e.content.question.title,link:e.content.url,description:e.content.type===`zvideo`?`<img src=${e.content.video.url}/>`:e.content.content,pubDate:t((e.content.type===`article`?e.content.updated:e.content.updated_time)*1e3)})}}export{s as route};