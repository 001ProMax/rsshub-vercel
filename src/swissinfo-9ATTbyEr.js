import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{load as r}from"cheerio";const i={path:`/:language?/:category?`,categories:[`new-media`],example:`/swissinfo/eng/latest-news`,parameters:{language:`Language, eng by default`,category:`Category, Latest News by default`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`swissinfo.ch/:language/:category`,`swissinfo.ch/`]}],name:`Category`,maintainers:[`nczitzk`],handler:a};async function a(i){let a=i.req.param(`language`)??`eng`,o=i.req.param(`category`)??`latest-news`,s=`https://www.swissinfo.ch`,c=`${s}/${a}/${o}`,l=await n({method:`get`,url:c}),u=r(l.data),d=u(`title`).text(),f=await n({method:`get`,url:`${s}${u(`main div[data-fragment-placeholder]`).attr(`data-fragment-placeholder`)}`});u=r(f.data);let p=u(`.si-teaser__link`).slice(0,i.req.query(`limit`)?Number.parseInt(i.req.query(`limit`)):20).toArray().map(t=>(t=u(t),{link:`${s}${t.attr(`href`)}`,title:t.find(`.si-teaser__title`).text(),pubDate:e(t.find(`.si-teaser__date`).attr(`datetime`))}));return p=await Promise.all(p.map(e=>t.tryGet(e.link,async()=>{let t=await n({method:`get`,url:e.link}),i=r(t.data);return i(`.si-detail__content .si-grid`).remove(),i(`.si-detail__content .si-teaser`).remove(),i(`.show-for-sr, time, address, .si-detail__translation`).remove(),i(`picture`).each(function(){i(this).html(`<img src="${i(this).find(`source`).first().attr(`srcset`)}">`)}),e.description=i(`.si-detail__content`).html(),e.author=i(`meta[name="author"]`).attr(`content`),e.guid=t.data.match(/content_id: "(.*)",/)[1],e}))),{title:d,link:c,item:p}}export{i as route};