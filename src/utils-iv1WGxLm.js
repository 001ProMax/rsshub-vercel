import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import{art as r}from"./render-DOz85fGU.js";import{got_default as i}from"./got-CB83B8oA.js";import a from"node:path";import o from"dayjs";import{load as s}from"cheerio";import{JSDOM as c}from"jsdom";import l from"dayjs/plugin/localizedFormat.js";import"dayjs/locale/zh-cn.js";t(),o.extend(l);function u(e){let t={};try{let n=new c(e,{runScripts:`dangerously`});t=n.window.__NUXT__.data[0]}catch{throw Error(`Nuxt 框架信息提取失败，请报告这个问题`)}return t}function d(e){return`<img src="${e}"><br/>`}async function f(e){let t=await i(e),n=t.data,r=s(n),a=r(`.description`).html();return{content:a}}async function p(e){let t=await i(e),r=t.data,a=s(r),o=a(`.detail-body-container`).html(),c=a(`.topics-articleHead__date`).text();return o=o.replaceAll(`src="/topics/`,`src="https://www.nintendo.com.hk/topics/`),{content:o,pubDate:n(c,`YYYY.M.D`)}}const m=(e,t)=>Promise.all(e.map(async e=>{let n=await t.tryGet(e.link,()=>f(e.link));return{...e,...n}})),h=(e,t)=>Promise.all(e.map(async e=>{let n=await t.tryGet(e.url,()=>p(`https://www.nintendo.com.hk`+e.url));return{...e,...n}})),g=(t,n)=>Promise.all(t.map(async t=>{if(!t.link.startsWith(`https://www.nintendoswitch.com.cn/software/`))return t;let s=await n.tryGet(t.link,async()=>u((await i(t.link)).data)),c=s.data;return{...t,category:[...c.supportLanguages,...c.genre,...c.playMode],description:r(a.join(e,`templates/eshop_cn-23aed242.art`),{item:t,software:c,releaseDatetime:o(c.releaseDatetime).locale(`zh-cn`).format(`lll`)})}})),_=(e,t)=>Promise.all(e.map(async e=>{let r=await t.tryGet(e.link,async()=>u((await i(e.link)).data));return{...e,description:e.description+r.newsData.content,category:r.newsData.category,pubDate:n(r.newsData.releaseTime,`x`)}}));var v={ProcessItem:m,ProcessNews:h,ProcessNewsChina:_,ProcessItemChina:g,nuxtReader:u,generateImageLink:d};export{v as utils_default};