import{parseDate as e}from"./parse-date-D4osZfpm.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{ofetch_default as n}from"./ofetch-ZUQ1sEMc.js";import{load as r}from"cheerio";function i(e,t){return[...new Map(e.map(e=>[e[t],e])).values()]}function a(i){return t.tryGet(i.link,async()=>{let t=await n(i.link),a=r(t);if(a(`#link-ld-json`).length===0){let t=a(`meta[name="gtm-dataLayer"]`).attr(`content`);if(t){let n=JSON.parse(t);return{title:n.headline,pubDate:e(n.publication_date),description:a(`div.RichTextStoryBody`).html()||a(`:is(.VideoLead, .VideoPage-pageSubHeading)`).html(),category:n.tag_array.split(`,`),guid:a(`meta[name='brightspot.contentId']`).attr(`content`),author:n.author,...i}}else return i}let o=JSON.parse(a(`#link-ld-json`).text()),s;if(o[`@type`]===`NewsArticle`||Array.isArray(o)&&o.some(e=>e[`@type`]===`NewsArticle`)){s=Array.isArray(o)?o.find(e=>e[`@type`]===`NewsArticle`):o,a(`div.Enhancement`).remove();let t=a(`meta[property='article:section']`).attr(`content`);return{...i,title:s.headline,pubDate:e(s.datePublished),updated:e(s.dateModified),description:a(`div.RichTextStoryBody`).html()||a(`:is(.VideoLead, .VideoPage-pageSubHeading)`).html(),category:[...t?[t]:[],...s.keywords??[]],guid:a(`meta[name='brightspot.contentId']`).attr(`content`),author:s.author?.map(e=>e.mainEntity)}}else{s=o;let t=new URL(i.link),n=t.hash?a(t.hash).parent().find(`.LiveBlogPost-body`).html():s.description,r=t.hash?e(Number.parseInt(a(t.hash).parent().attr(`data-posted-date-timestamp`),10)):e(s.coverageStartTime);return{...i,category:s.keywords,pubDate:r,description:n,guid:a(`meta[name='brightspot.contentId']`).attr(`content`)}}})}export{a as fetchArticle,i as removeDuplicateByKey};