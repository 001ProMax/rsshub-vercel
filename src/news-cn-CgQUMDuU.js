import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{ofetch_default as n}from"./ofetch-ZUQ1sEMc.js";import{load as r}from"cheerio";const i={path:`/news-cn/:category?`,categories:[`game`],example:`/blizzard/news-cn/ow`,parameters:{category:`游戏类别, 默认为 ow`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`ow.blizzard.cn`,`wow.blizzard.cn`,`hs.blizzard.cn`],target:`/news-cn/`}],name:`暴雪游戏国服新闻`,maintainers:[`zhangpeng2k`],description:`
| 守望先锋 | 炉石传说 | 魔兽世界 |
|----------|----------|---------|
| ow       | hs       | wow     |
`,handler:u},a={ow:`守望先锋`,hs:`炉石传说`,wow:`魔兽世界`},o={ow:t=>t(`.list-data-container .list-item-container`).toArray().map(n=>(n=t(n),{title:n.find(`.content-title`).text(),link:n.find(`.fill-link`).attr(`href`),description:n.find(`.content-intro`).text(),pubDate:e(n.find(`.content-date`).text()),image:n.find(`.item-pic`).attr(`src`)})),hs:t=>t(`.article-container>a`).toArray().map(n=>(n=t(n),{title:n.find(`.title`).text(),link:n.attr(`href`),description:n.find(`.desc`).text(),pubDate:e(n.find(`.date`).attr(`data-time`)),image:n.find(`.article-img img`).attr(`src`)})),wow:t=>t(`.Pane-list>a`).toArray().map(n=>(n=t(n),{title:n.find(`.list-title`).text(),link:n.attr(`href`),description:n.find(`.list-desc`).text(),pubDate:e(n.find(`.list-time`).attr(`data-time`)),image:n.find(`.img-box img`).attr(`src`)}))},s={ow:e=>e(`.deatil-content`).first().html(),hs:e=>e(`.article`).first().html(),wow:e=>e(`.detail`).first().html()};function c(e,t){return o[e]?o[e](t):[]}async function l(e,i){return await t.tryGet(e.link,async()=>{let t=await n(e.link),a=r(t),o=s[i];return e.description=o(a),e})}async function u(e){let t=e.req.param(`category`)||`ow`;if(!a[t])throw Error(`Invalid category`);let i=`https://${t}.blizzard.cn/news`,o=await n(i),s=r(o),u=c(t,s);if(!u.length)throw Error(`No news found`);let d=await Promise.all(u.map(e=>l(e,t)));return{title:`${a[t]}新闻`,link:i,item:d}}export{i as route};