import"./esm-shims-CGUM9TC6.js";import{config as e}from"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as t}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as n}from"./cache-GwMhal7i.js";import"./md5-4BNsOP-F.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as r}from"./got-CB83B8oA.js";import{ViewType as i}from"./types-A5bA50Mg.js";import{header as a}from"./utils-DWrssr6M.js";const o={path:`/people/allCollections/:id`,categories:[`social-media`],view:i.Articles,example:`/zhihu/people/allCollections/87-44-49-67`,parameters:{id:`作者 id，可在用户主页 URL 中找到`},features:{requireConfig:[{name:`ZHIHU_COOKIES`,description:``}],requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.zhihu.com/people/:id`]}],name:`用户全部收藏内容`,maintainers:[`Healthyyue`],handler:s};async function s(i){let o=i.req.param(`id`),s=`https://api.zhihu.com/people/${o}/collections`,c=await r(s,{headers:{cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/people/${o}/collections`}}),l=c.data.data,u=await Promise.all(l.map(async t=>{let i=await r(`https://www.zhihu.com/api/v4/collections/${t.id}/items?offset=0&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${t.id}`}}),{data:o,paging:{totals:s}}=i.data;if(s>20){let i=Array.from({length:Math.ceil(s/20)-1},(e,t)=>(t+1)*20),c=await Promise.all(i.map(i=>n.tryGet(`https://www.zhihu.com/api/v4/collections/${t.id}/items?offset=${i}&limit=20`,async()=>{let n=await r(`https://www.zhihu.com/api/v4/collections/${t.id}/items?offset=${i}&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${t.id}`}});return n.data.data})));o.push(...c.flat())}return{collectionId:t.id,collectionTitle:t.title,items:o}})),d=u.flatMap(e=>e.items.map(t=>({...t,collectionTitle:e.collectionTitle})));return{title:`${l[0].creator.name}的知乎收藏`,link:`https://www.zhihu.com/people/${o}/collections`,item:d.map(e=>{let n=e.content;return{title:n.type===`article`||n.type===`zvideo`?n.title:n.question.title,link:n.url,description:n.type===`zvideo`?`<img src=${n.video.url}/>`:n.content,pubDate:t((n.type===`article`?n.updated:n.updated_time)*1e3),category:[e.collectionTitle]}})}}export{o as route};