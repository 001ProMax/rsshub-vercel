import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as e}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import"./got-CB83B8oA.js";import"./config-not-found-BVqhRP9D.js";import{utils_default as t}from"./utils-C4mD3AG0.js";import{load as n}from"cheerio";const r={path:`/indexers/pianyuan/results/search/api`,radar:[{source:[`pianyuan.org/`],target:`/index`}],name:`Unknown`,maintainers:[`jerry1119`],handler:i,url:`pianyuan.org/`};async function i(r){let i=`https://pianyuan.org/`,a=r.originalUrl.split(`&q=`)[1],o=`https://pianyuan.org/search?q=${a}`,s=await t.request(o,e),c=n(s.data),l=c(`.nomt > a`).toArray().map(e=>c(e).attr(`href`));if(l.length===0)throw Error(`pianyuan 搜索失败`);let u=[];await Promise.all(l.map(async r=>{let a=new URL(r,i).href,o=await e.tryGet(a,async()=>{let r=await t.request(a,e),i=n(r.data);i(`.ico.ico_bt`).toArray().map(e=>u.push(c(e).attr(`href`)))});return o}));let d=await t.ProcessFeed(u,e);return{title:`片源网`,description:`搜索`,link:i,item:d}}export{r as route};