import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{ofetch_default as n}from"./ofetch-ZUQ1sEMc.js";import*as r from"cheerio";const i={path:`/tag/:tag`,example:`/wired/tag/facebook`,parameters:{tag:`Tag name`},radar:[{source:[`www.wired.com/tag/:tag/`]}],name:`Tags`,maintainers:[`Naiqus`],handler:a};async function a(i){let a=`https://www.wired.com`,{tag:o}=i.req.param(),s=`${a}/tag/${o}/`,c=await n(s),l=r.load(c),u=JSON.parse(l(`script:contains("window.__PRELOADED_STATE__")`).text().match(/window\.__PRELOADED_STATE__ = (.*);/)?.[1]??`{}`),d=u.transformed.tag.items.map(t=>({title:t.dangerousHed,description:t.dangerousDek,link:`${a}${t.url}`,pubDate:e(t.date),author:t.contributors.author.items.map(e=>e.name).join(`, `),category:[t.rubric.name]})),f=await Promise.all(d.map(e=>t.tryGet(e.link,async()=>{let t=await n(e.link),i=r.load(t),a=JSON.parse(i(`script:contains("window.__PRELOADED_STATE__")`).text().match(/window\.__PRELOADED_STATE__ = (.*);/)?.[1]??`{}`),o=i(`div[data-testid*="ContentHeaderLeadAsset"]`);o.find(`button`).remove(),o.find(`video`)&&(o.find(`video`).attr(`src`,i(`link[rel="preload"][as="video"]`).attr(`href`)),o.find(`video`).attr(`controls`,``),o.find(`video`).attr(`preload`,`metadata`),o.find(`video`).removeAttr(`autoplay`));let s=i(`.body__inner-container`).toArray().map(e=>{let t=i(e);return t.find(`noscript`).each((e,t)=>{let n=i(t);n.replaceWith(n.html()||``)}),t.html()}).join(``);return e.description=(i(`div[class^=ContentHeaderDek]`).prop(`outerHTML`)||``)+o.prop(`outerHTML`)+s,e.category=[...new Set([...e.category,...a.transformed.article.tagCloud.tags.map(e=>e.tag)])],e})));return{title:u.transformed[`head.title`],description:u.transformed[`head.description`],link:s,image:`${a}${u.transformed.logo.sources.sm.url}`,language:`en`,item:f}}export{i as route};