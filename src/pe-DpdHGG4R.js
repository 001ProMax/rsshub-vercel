import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{load as r}from"cheerio";const i={path:`/pe/:id?`,radar:[{source:[`pe2016.sspu.edu.cn/:id/list.htm`],target:`/pe/:id`}],name:`Unknown`,maintainers:[`nczitzk`],handler:a};async function a(i){let{id:a=`342`}=i.req.param(),o=i.req.query(`limit`)?Number.parseInt(i.req.query(`limit`),10):30,s=`https://pe2016.sspu.edu.cn`,c=new URL(`${a}/list.htm`,s).href,{data:l}=await n(c),u=r(l),d=u(`table.wp_article_list_table a[title]`).slice(0,o).toArray().map(t=>(t=u(t),{title:t.text(),link:new URL(t.prop(`href`),s).href,pubDate:e(t.prev().text())}));d=await Promise.all(d.map(e=>t.tryGet(e.link,async()=>{if(e.link.endsWith(`htm`)){let{data:t}=await n(e.link),i=r(t),a=i(`div.time`).text();e.title=i(`div.title`).text(),e.description=i(`div.wp_articlecontent`).html(),e.author=a.match(/来源：(.*?)\s/)?.[1]??void 0,e.pubDate=a.match(/发布时间：(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})\s/)?.[1]??void 0}return e})));let f=`上海第二工业大学`,p=u(`title`).text(),m=new URL(u(`link[rel="shortcut icon"]`).prop(`href`),s).href;return{item:d,title:`${f} - ${p}`,link:c,description:u(`div.tyb_headtitle1`).text(),language:u(`html`).prop(`lang`),icon:m,logo:m,subtitle:p,author:f}}export{i as route};