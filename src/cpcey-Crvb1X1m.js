import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{load as r}from"cheerio";const i=`https://cpc.ey.gov.tw`,a={xwg:{name:`新闻稿`,url:`/Page/A3412E2A5A7B398F`},xfzx:{name:`消费资讯`,url:`/Page/E414CC218269CCE8`}},o={path:`/:type?`,categories:[`government`],example:`/cpcey/xwg`,parameters:{type:"默认为 `xwg`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`消费资讯`,maintainers:[`Fatpandac`],handler:s,description:`| 新闻稿 | 消费资讯 |
| :----: | :------: |
|   xwg  |   xfzx   |`};async function s(o){let s=o.req.param(`type`)??`xwg`,c=i+a[s].url,l=await n.get(c),u=r(l.data),d=u(`div.words > ul > li`).toArray().map(t=>{let n=u(t).find(`span`).text(),r=n.split(`-`),a=Number.parseInt(r[0])+1911+`/`+r[1]+`/`+r[2];return{link:i+u(t).find(`a`).attr(`href`),title:u(t).find(`a`).attr(`title`),pubDate:e(a,`YYYY/MM/DD`)}}),f=await Promise.all(d.map(async e=>{let i=``,a=!e.link.includes(`.html`);return a&&(i=await t.tryGet(e.link,async()=>{let t=await n.get(e.link),i=r(t.data),a=i(`div.words > div.graybg.ail > div`).html();return a})),e.description=i,e}));return{title:`行政院消费者保护会-${a[s].name}`,link:c,item:f}}export{o as route};