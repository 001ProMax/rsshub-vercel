import"./esm-shims-CGUM9TC6.js";import{config as e}from"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as t}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as n}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as r}from"./got-CB83B8oA.js";import{ViewType as i}from"./types-A5bA50Mg.js";const a={path:`/user/:id`,categories:[`picture`],view:i.Pictures,example:`/fantia/user/3498`,parameters:{id:`User id, can be found in user profile URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`fantia.jp/fanclubs/:id`]}],name:`User Posts`,maintainers:[`nczitzk`],handler:o};async function o(i){let a=`https://fantia.jp`,o=`${a}/api/v1/fanclubs/${i.req.param(`id`)}`,s=await r({method:`get`,url:a,headers:{Cookie:e.fantia.cookies??``}}),c=s.data.match(/name="csrf-token" content="(.*?)"\s?\/>/)[1],l=await r({method:`get`,url:o,headers:{Cookie:e.fantia.cookies??``}}),u=l.data.fanclub.recent_posts.map(e=>({title:e.title,link:`${a}/api/v1/posts/${e.id}`,description:`<p>${e.comment}</p>`,pubDate:t(e.posted_at)})),d=await Promise.all(u.map(t=>n.tryGet(t.link,async()=>{let n=await r({method:`get`,url:t.link,headers:{Cookie:e.fantia.cookies??``,"X-CSRF-Token":c,Accept:`application/json, text/plain, */*`,Referer:`${a}/`,"X-Requested-With":`XMLHttpRequest`}});return t.link=t.link.replace(`api/v1/`,``),t.description+=`<img src="${n.data.post?.thumb?.large??n.data.post.thumb_micro}">`,t})));return{title:`Fantia - ${l.data.fanclub.fanclub_name_with_creator_name}`,link:`${a}/fanclubs/${i.req.param(`id`)}`,item:d}}export{a as route};