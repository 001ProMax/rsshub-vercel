import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import{cache_default as r}from"./cache-GwMhal7i.js";import{art as i}from"./render-DOz85fGU.js";import{got_default as a}from"./got-CB83B8oA.js";import o from"node:path";import{load as s}from"cheerio";t();const c=t=>{let n=s(t),r=n(`h2`).first().text(),a=n(`h2.author`).first().text(),c=n(`.desc`).first().text(),l=n(`img.cover__backcover`).attr(`src`),u=n(`img.cover__backcover`).attr(`alt`);return l||(l=n(`img.img-responsive`).attr(`data-src`),u=n(`img.img-responsive`).attr(`alt`)),i(o.join(e,`templates/book-e2535a5a.art`),{title:r,author:a,description:c,imageSrc:l,imageAlt:u})},l=e=>{let t=e(`script`).toArray().find(e=>{let t=e.children[0];return!t||!t.data?!1:t.data.includes(`post_date`)});if(t.length===0)return;let r=t.children[0].data.match(/(?<="post_date":").*?(?=")/);if(r)return n(r[0])},u=e=>{let t=s(e),n=t(`h2.read-down-text`).first().html(),r=``;return t(`.awesome-list>li`).map((e,t)=>{let n=c(t);return r+=n,n}),{description:n,content:r,pubDate:l(t)}},d=t=>{let n=s(t),r=n(`h2.hdr-smalltxt`).first().html(),a=n(`div.img-block>img`).first().attr(`src`),c=n(`div.img-block>img`).first().attr(`alt`),u=``,d=i(o.join(e,`templates/articleHeader-7457abf4.art`),{description:r,imageSrc:a,imageAlt:c});return n(`div.main-content>p,div.main-content>ul`).map((e,t)=>{let n=s(t);return u+=n.html(),n}),{description:d,content:u,pubDate:l(n)}},f=(e,t,n)=>Promise.all(e.map(e=>r.tryGet(e.url,async()=>{let t=await a(e.url),r=t.data,i=n(r),o={title:e.title,description:i.description+`<br>`+i.content,pubDate:i.pubDate,link:e.url};return o})));var p={parseList:f,parseBooks:u,parseArticle:d};export{p as utils_default};