import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as r}from"./cache-GwMhal7i.js";import{art as i}from"./render-DOz85fGU.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as a}from"./got-CB83B8oA.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import s from"node:path";import{load as c}from"cheerio";t();const l={path:`/`,radar:[{source:[`shuiguopai.com/`],target:``}],name:`Unknown`,maintainers:[`nczitzk`],handler:u,url:`shuiguopai.com/`};async function u(t){let l=`https://sgptv.vip`,u=`https://api.cbbee0.com`,d=`${u}/v1_2/homePage`,f=`${u}/v1_2/filmInfo`,p=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):50,m=await a({method:`post`,url:d,json:{device_id:``,hm:`008-api`,last_page:0,length:p,ltype:1,page:1,userToken:``}}),h=m.data.data.list.map(e=>({title:e.title,guid:e.library_id,link:`${l}/play-details/${e.library_id}`,pubDate:o(n(e.show_time_origin,`YYYY-MM-DD HH:mm:ss`),8),category:e.tags.map(e=>e.tag_title)}));return h=await Promise.all(h.map(t=>r.tryGet(t.link,async()=>{let n=await a({method:`get`,url:t.link}),r=c(n.data);r(`iframe`).remove();let o,l=n.data.match(/film_id:"([\d,]+)",/)?.[1];if(l){let e=await a({method:`post`,url:f,json:{device_id:``,film_id:l,hm:`008-api`,userToken:``}}),n=e.data.data;o=n.map(e=>e.download_url),t.category=n.flatMap(e=>e.tags.map(e=>e.tag_title)),t.author=n.map(e=>e.actor).join(` `)}return t.description=i(s.join(e,`templates/description-3864cae2.art`),{videos:o,description:r(`.content`).html()}),t}))),{title:`水果派`,link:l,item:h}}export{l as route};