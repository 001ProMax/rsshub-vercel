import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{load as r}from"cheerio";const i=e=>e(`qianp:token`,async()=>{let e=await n(`https://qianp.com/news/recommend/`),t=e.headers[`set-cookie`].find(e=>e.startsWith(`token=`))?.split(`;`)[0]?.split(`=`)[1],r=e.headers[`set-cookie`].find(e=>e.startsWith(`secret=`))?.split(`;`)[0]?.split(`=`)[1];return{token:t,secret:r}}),a={path:`/news/:path{.+}?`,name:`Unknown`,maintainers:[],handler:o};async function o(a){let o=`https://qianp.com`,{path:s=`news/recommend`}=a.req.param(),c=`${o}/${s}/`,{token:l,secret:u}=await i(t.tryGet),d={cookie:l?`t=${l}; r=${u-100}`:void 0},{data:f}=await n(c,{headers:d}),p=r(f),m=p(`.newslist .infor`).toArray().map(e=>{e=p(e);let t=e.find(`a`).first();return{title:t.attr(`title`),link:t.attr(`href`)}}),h=await Promise.all(m.map(i=>t.tryGet(i.link,async()=>{let{data:t}=await n(i.link,{headers:d}),a=r(t);return i.category=[...new Set(a(`meta[name=keywords]`).attr(`content`).split(`ï¼Œ`))],i.author=a(`meta[name=author]`).attr(`content`),i.pubDate=e(a(`meta[property="bytedance:published_time"]`).attr(`content`)),i.description=a(`.news_center`).html(),i})));return{title:p(`head title`).text(),description:p(`meta[name="description"]`).attr(`content`),link:c,image:`${o}/favicon.ico`,item:h}}export{a as route};