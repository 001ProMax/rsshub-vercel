import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as r}from"./cache-GwMhal7i.js";import{art as i}from"./render-DOz85fGU.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as a}from"./got-CB83B8oA.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/:bookName/book-series/:bookId`,radar:[{source:[`routledge.com/:bookName/book-series/:bookId`]}],name:`Unknown`,maintainers:[`TonyRL`],handler:l};async function l(t){let{bookName:c,bookId:l}=t.req.param(),u=`https://www.routledge.com/${c}/book-series/${l}`,{data:d}=await a(u,{headers:{accept:`text/html, */*; q=0.01`},searchParams:{publishedFilter:`alltitles`,pd:`published,forthcoming`,pg:1,pp:12,so:`pub`,view:`list`}}),f=s(d),p=f(`.row.book`).toArray().map(e=>{e=f(e);let t=e.find(`h3 a`),r=e.find(`p.description`),i=e.find(`p.description`).prev().text().split(`
`);return{title:t.text(),link:t.attr(`href`),description:r.text(),pubDate:n(i.pop().trim(),`MMMM DD, YYYY`),author:i.map(e=>e.trim()).filter(Boolean).join(`, `)}}),m=await Promise.all(p.map(t=>r.tryGet(t.link,async()=>{let{data:n}=await a(t.link),r=s(n),c=r(`meta[property="books:isbn"]`).attr(`content`),{data:l}=await a(`https://productimages.routledge.com`,{searchParams:{isbn:c,size:`amazon`,ext:`jpg`}}),u=r(`.sticky-div`);return u.find(`button.accordion-button`).contents().unwrap(),u.find(`.fa-shopping-cart`).parent().parent().remove(),t.description=i(o.join(e,`templates/description-c2244266.art`),{image:l,description:u.html()}),t})));return{title:f(`head title`).text(),description:f(`head meta[name="description"]`).attr(`content`),link:u,item:m}}export{c as route};