import"./esm-shims-DtWyl6zt.js";import{config as e}from"./config-CT-9jq-j.js";import"./logger-BsClR5PH.js";import"./dist-Bbb0mfHh.js";import"./helpers-DzX-lcQO.js";import{cache_default as t}from"./cache-DNP0KCHb.js";import"./parse-date-Bgabdhlb.js";import"./ofetch-Dnmc-sKl.js";import{got_default as n}from"./got-CdHCxDMi.js";import{InvalidParameterError as r}from"./invalid-parameter-BQKLs9qN.js";import{ConfigNotFoundError as i}from"./config-not-found-2m672-Jl.js";import{wait as a}from"./wait-KkUD0owc.js";import{fetchArticle as o}from"./wechat-mp-CYNIvc96.js";let s=0;const c={path:`/:id/:params?`,name:`Test`,maintainers:[`DIYgod`,`NeverBehave`],handler:l};async function l(c){if(c.req.param(`id`)===`error`)throw Error(`Error test`);if(c.req.param(`id`)===`httperror`&&await n({method:`get`,url:`https://httpbingo.org/status/404`}),c.req.param(`id`)===`config-not-found-error`)throw new i(`Test config not found error`);if(c.req.param(`id`)===`invalid-parameter-error`)throw new r(`Test invalid parameter error`);if(c.req.param(`id`)===`redirect`){c.set(`redirect`,`/test/1`);return}let l=[],u=null;switch(c.req.param(`id`)){case`filter`:l=[{title:`Filter Title1`,description:`Description1`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/-1`,author:`DIYgod0`,category:[`Category0`,`Category1`]},{title:`Filter Title2`,description:`Description2`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/0`,author:`DIYgod0`,category:[`Category0`,`Category1`,`Category2`]},{title:`Filter Title3`,description:`Description3`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/1`,author:`DIYgod0`,category:`Category3`}];break;case`filter-illegal-category`:l.push({title:`TitleIllegal`,description:`DescriptionIllegal`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/1`,author:`DIYgod0`,category:[1,`CategoryIllegal`,!0,null,void 0,{type:`object`}]});break;case`long`:l.push({title:`Long Title `.repeat(50),description:`Long Description `.repeat(10),pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/0`,author:`DIYgod0`});break;case`cache`:{let e=await t.tryGet(`test`,()=>({text:`Cache${++s}`}));l.push({title:`Cache Title`,description:e.text,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/0`,author:`DIYgod0`});break}case`refreshCache`:{let e=await t.get(`refreshCache`),n=await t.get(`noRefreshCache`,!1);e||(e=`0`,await t.set(`refreshCache`,`1`)),n||(n=`0`,await t.set(`noRefreshCache`,`1`,void 0)),l.push({title:`Cache Title`,description:e+` `+n,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/0`,author:`DIYgod0`});break}case`cacheUrlKey`:{let n=await t.tryGet(new URL(`https://rsshub.app`),()=>({text:`Cache${++s}`}),e.cache.routeExpire*2);l.push({title:`Cache Title`,description:n.text,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/0`,author:`DIYgod0`});break}case`complicated`:u=`https://mock.com/DIYgod/RSSHub.png`,l.push({title:`Complicated Title`,description:`<a href="/DIYgod/RSSHub"></a>
<img src="/DIYgod/RSSHub.jpg">
<script>alert(1);<\/script>
<a href="http://mock.com/DIYgod/RSSHub"></a>
<img src="/DIYgod/RSSHub.jpg" data-src="/DIYgod/RSSHub0.jpg">
<img data-src="/DIYgod/RSSHub.jpg">
<img data-mock="/DIYgod/RSSHub.png">
<img mock="/DIYgod/RSSHub.gif">
<img src="http://mock.com/DIYgod/DIYgod/RSSHub">
<img src="/DIYgod/RSSHub.jpg" onclick="alert(1);" onerror="alert(1);" onload="alert(1);">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`//mock.com/DIYgod/RSSHub`,author:`DIYgod`},{title:`Complicated Title`,description:`<a href="/DIYgod/RSSHub"></a>
<img src="/DIYgod/RSSHub.jpg">`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://mock.com/DIYgod/RSSHub`,author:`DIYgod`},{title:`Complicated Title`,description:`<a href="/DIYgod/RSSHub"></a>
<img src="/DIYgod/RSSHub.jpg">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`//mock.com/DIYgod/RSSHub`,author:`DIYgod`,enclosure_url:`https://mock.com/DIYgod/RSSHub.png`,enclosure_type:`image/png`,itunes_item_image:`https://mock.com/DIYgod/RSSHub.gif`},{title:`Complicated Title`,description:`<a href="/DIYgod/RSSHub"></a>
<img src="/DIYgod/RSSHub.jpg">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`//mock.com/DIYgod/RSSHub`,author:`DIYgod`,image:`https://mock.com/DIYgod/RSSHub.jpg`});break;case`multimedia`:l.push({title:`Multimedia Title`,description:`<img src="/DIYgod/RSSHub.jpg">
<video src="/DIYgod/RSSHub.mp4"></video>
<video poster="/DIYgod/RSSHub.jpg">
<source src="/DIYgod/RSSHub.mp4" type="video/mp4">
<source src="/DIYgod/RSSHub.webm" type="video/webm">
</video>
<audio src="/DIYgod/RSSHub.mp3"></audio>
<iframe src="/DIYgod/RSSHub.html"></iframe>`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://mock.com/DIYgod/RSSHub`,author:`DIYgod`},{title:`Multimedia Title`,description:`<img src="/DIYgod/RSSHub.jpg">
<video src="/DIYgod/RSSHub.mp4"></video>`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://mock.com/DIYgod/RSSHub`,author:`DIYgod`,enclosure_url:`https://mock.com/DIYgod/RSSHub.mp4`,enclosure_type:`video/mp4`});break;case`sort`:l.push({title:`Sort Title 0`,link:`https://github.com/DIYgod/RSSHub/issues/s1`,author:`DIYgod0`},{title:`Sort Title 1`,link:`https://github.com/DIYgod/RSSHub/issues/s1`,author:`DIYgod0`},{title:`Sort Title 2`,link:`https://github.com/DIYgod/RSSHub/issues/s2`,pubDate:new Date(1546272e6-100*1e3).toUTCString(),author:`DIYgod0`},{title:`Sort Title 3`,link:`https://github.com/DIYgod/RSSHub/issues/s3`,pubDate:new Date(1546272e6).toUTCString(),author:`DIYgod0`});break;case`mess`:l.push({title:`Mess Title`,link:`/DIYgod/RSSHub/issues/0`,pubDate:1546272e6,author:`DIYgod0`});break;case`opencc`:l.push({title:`小可愛`,description:`宇宙無敵`,link:`/DIYgod/RSSHub/issues/0`,pubDate:new Date(1546272e6).toUTCString(),author:`DIYgod0`});break;case`brief`:l.push({title:`小可愛`,description:`<p>宇宙無敵</p><br>`.repeat(1e3),link:`/DIYgod/RSSHub/issues/0`,pubDate:new Date(1546272e6).toUTCString(),author:`DIYgod0`});break;case`json`:l.push({title:`Title0`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/-3`},{title:`Title1`,description:`Description1`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/-2`,author:`DIYgod0 `,category:`Category0`},{title:`Title2 HTML in description`,description:`<a href="https://github.com/DIYgod/RSSHub">RSSHub</a>`,pubDate:new Date(`2019-3-1`).toUTCString(),updated:new Date(`2019-3-2`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/-1`,author:[{name:` DIYgod1`},{name:`DIYgod2 `}],category:[`Category0`,`Category1`]},{title:`Title3 HTML in content`,content:{html:`<a href="https://github.com/DIYgod/RSSHub">DIYgod/RSSHub</a>`},pubDate:new Date(`2019-3-1`).toUTCString(),updated:new Date(`2019-3-2`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/0`,author:[{name:`   DIYgod3`},{name:`DIYgod4   `},{name:`DIYgod5   `}],category:[`Category1`],enclosure_url:`https://github.com/DIYgod/RSSHub/issues/0`,enclosure_type:`image/jpeg`,enclosure_length:3661,itunes_duration:36610},{title:`Title4 author is null`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/pull/11555`,author:null});break;case`gpt`:l.push({title:`Title0`,description:`Description0`,pubDate:new Date(`2019-3-1`).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/0`});break;default:}for(let e=1;e<6;e++)l.push({title:`Title${e}`,description:`Description${e}`,pubDate:new Date((c.req.param(`id`)===`current_time`?new Date:1546272e6)-e*10*1e3).toUTCString(),link:`https://github.com/DIYgod/RSSHub/issues/${e}`,author:`DIYgod${e}`});if(c.req.param(`id`)===`empty`&&(l=null),c.req.param(`id`)===`allow_empty`&&(l=null),c.req.param(`id`)===`enclosure`&&(l=[{title:``,link:`https://github.com/DIYgod/RSSHub/issues/1`,enclosure_url:`https://github.com/DIYgod/RSSHub/issues/1`,enclosure_length:3661,itunes_duration:36610}]),c.req.param(`id`)===`slow`&&await a(1e3),c.req.param(`id`)===`slow4`&&await a(4e3),c.req.query(`mode`)===`fulltext`&&(l=[{title:``,link:`https://m.thepaper.cn/newsDetail_forward_4059298`}]),c.req.param(`id`)===`wechat-mp`){let e=c.req.param(`params`);if(!e)throw new r(`Invalid parameter`);let t=`https:/mp.weixin.qq.com/s`+(e.includes(`&`)?`?`:`/`)+e;l=[await o(t)]}return{image:u,title:`Test ${c.req.param(`id`)}`,itunes_author:c.req.param(`id`)===`enclosure`?`DIYgod`:null,link:`https://github.com/DIYgod/RSSHub`,item:l,allowEmpty:c.req.param(`id`)===`allow_empty`,description:c.req.param(`id`)===`complicated`?`<img src="http://mock.com/DIYgod/DIYgod/RSSHub">`:c.req.param(`id`)===`multimedia`?`<video src="http://mock.com/DIYgod/DIYgod/RSSHub"></video>`:`A test route for RSSHub`}}export{c as route};