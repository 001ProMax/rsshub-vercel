import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as n}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as r}from"./cache-GwMhal7i.js";import{art as i}from"./render-DOz85fGU.js";import"./ofetch-ZUQ1sEMc.js";import"./got-CB83B8oA.js";import{ViewType as a}from"./types-A5bA50Mg.js";import{getFeed as o,getFeedGenerator as s,resolveHandle as c}from"./utils-DCMbVSTl.js";import l from"node:path";t();const u={path:`/profile/:handle/feed/:space/:routeParams?`,categories:[`social-media`],view:a.SocialMedia,example:`/bsky.app/profile/jaz.bsky.social/feed/cv:cat`,parameters:{handle:`User handle, can be found in URL`,space:`Space ID, can be found in URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Feeds`,maintainers:[`FerrisChi`],handler:d};async function d(t){let a=t.req.param(`handle`),u=t.req.param(`space`),d=await c(a,r.tryGet),f=`at://${d}/app.bsky.feed.generator/${u}`,p=await s(f,r.tryGet),m=await o(f,r.tryGet),h=m.feed.map(({post:t})=>({title:t.record.text.split(`
`)[0],description:i(l.join(e,`templates/post-7b0043bb.art`),{text:t.record.text.replaceAll(`
`,`<br>`),embed:t.embed}),author:t.author.displayName,pubDate:n(t.record.createdAt),link:`https://bsky.app/profile/${t.author.handle}/post/${t.uri.split(`app.bsky.feed.post/`)[1]}`,upvotes:t.likeCount,comments:t.replyCount}));return t.set(`json`,{DID:d,profile:p,feeds:m}),{title:`${p.view.displayName} â€” Bluesky`,description:p.view.description?.replaceAll(`
`,` `),link:`https://bsky.app/profile/${a}/feed/${u}`,image:p.view.avatar,icon:p.view.avatar,logo:p.view.avatar,item:h,allowEmpty:!0}}export{u as route};