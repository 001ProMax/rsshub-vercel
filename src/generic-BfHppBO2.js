import"./esm-shims-CGUM9TC6.js";import{config as e}from"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as t}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as n}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as r}from"./got-CB83B8oA.js";import{timezone as i}from"./timezone-BrNu6iXe.js";import{finishArticleItem as a}from"./wechat-mp-D9Desb6x.js";import{load as o}from"cheerio";const s=`https://www.nmpa.gov.cn`,c={path:`/nmpa/*`,name:`Unknown`,maintainers:[],handler:l};async function l(c){let l=c.params[0],u=`${s}/${l.endsWith(`/`)?l.slice(0,-1):l}/index.html`,d=await n.tryGet(u,async()=>{let{data:e}=await r(u),n=o(e);return{title:n(`head title`).text(),description:n(`meta[name=ColumnDescription]`).attr(`content`),items:n(`.list ul li`).toArray().map(e=>(e=n(e),{title:e.find(`a`).text().trim(),link:new URL(e.find(`a`).attr(`href`),s).href,pubDate:t(e.find(`span`).text(),`YYYY-MM-DD`)}))}},e.cache.routeExpire,!1),f=await Promise.all(d.items.map(e=>/^https:\/\/www\.nmpa\.gov\.cn\//.test(e.link)?n.tryGet(e.link,async()=>{let{data:n}=await r(e.link),a=o(n);return e.description=a(`.text`).html(),e.pubDate=i(t(a(`meta[name="PubDate"]`).attr(`content`)),8),e}):/^https:\/\/mp\.weixin\.qq\.com\//.test(e.link)?a(e):e));return{title:d.title,description:d.description,link:u,item:f}}export{c as route};