import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./proxy-C5Qog9Rm.js";import{cache_default as t}from"./cache-GwMhal7i.js";import{puppeteer_default as n}from"./puppeteer-U-cQNky4.js";import{load as r}from"cheerio";const i={path:`/publications/:id`,radar:[{source:[`researchgate.net/profile/:username`],target:`/publications/:username`}],name:`Unknown`,maintainers:[],handler:a};async function a(i){let a=i.req.param(`id`),o=`https://www.researchgate.net/profile/${a}`,s=await n(),c=await s.newPage();await c.setRequestInterception(!0),c.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),await c.goto(o);let l=await c.evaluate(()=>document.documentElement.innerHTML);await c.close();let u=r(l),d=u(`div[itemprop="headline"] a`).toArray().slice(0,i.req.query(`limit`)?Number(i.req.query(`limit`)):15).map(e=>(e=u(e),{title:e.text(),link:e.attr(`href`)})),f=await Promise.all(d.map(n=>t.tryGet(n.link,async()=>{let t=await s.newPage();await t.setRequestInterception(!0),t.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),await t.goto(n.link);let i=await t.evaluate(()=>document.documentElement.innerHTML);await t.close();let a=r(i);n.doi=a(`meta[property="citation_doi"]`).attr(`content`),n.pubDate=e(a(`meta[property="citation_publication_date"]`).attr(`content`));let o=[];return a(`meta[property="citation_author"]`).each(function(){o.push(a(this).attr(`content`))}),n.author=o.join(`, `),n.description=a(`div[itemprop="description"]`).html(),n})));return await s.close(),{title:`${u(`meta[property="profile:username"]`).attr(`content`)}'s Publications - ResearchGate`,link:o,item:f}}export{i as route};