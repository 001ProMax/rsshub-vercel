import"./esm-shims-DtWyl6zt.js";import"./config-CT-9jq-j.js";import"./logger-BsClR5PH.js";import"./dist-Bbb0mfHh.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import"./ofetch-Dnmc-sKl.js";import{ViewType as t}from"./types-A5bA50Mg.js";import{InvalidParameterError as n}from"./invalid-parameter-BQKLs9qN.js";import"./config-not-found-2m672-Jl.js";import{CONFIG_OPTIONS as r,getClient as i,parsePost as a,postFilter as o}from"./utils-D8D55Ob5.js";const s=async t=>{let r=Number.parseInt(t.req.query(`limit`)??`20`,10),s=t.req.param(`name`),c=t.req.param(`media`)===`media`;if(!s.startsWith(`@`))throw new n(`ユーザー名は@で始まる必要があります`);let l=i(),u=await l.getPersonaByName({name:s.slice(1)}),d=u.persona,f=await l.getPersonalTimeline({personaId:d?.personaId,limit:r,mediaOnly:c});return{title:`${d?.name} - ${c?`メディア`:`ポスト`}`,image:d?.avatarUrl,item:f?.posts?.filter(o).map(t=>({title:`@${d?.name}`,description:a(t),pubDate:e(t.createdAt.seconds*1e3),guid:t.postId,author:d?.name,link:`https://mixi.social/@${d?.name}/posts/${t.postId}`}))??[]}},c={path:`/user/:name/:media?`,name:`ユーザー`,categories:[`social-media`],example:`/mixi2/user/@deyo`,parameters:{name:{description:`@で始まるユーザー名`},media:{description:"`media`を入力するとメディアを含むポストのみを取得、デフォルトは空で全てのポストを取得"}},features:{requireConfig:r,supportRadar:!0},radar:[{source:[`mixi.social/:id`],target:`/user/:id`,title:`ユーザー - ポスト`},{source:[`mixi.social/:id`],target:`/user/:id/media`,title:`ユーザー - メディア`}],view:t.SocialMedia,handler:s,maintainers:[`KarasuShin`]};export{c as route};