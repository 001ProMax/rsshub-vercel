import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{load as i}from"cheerio";const a={path:`/today/:need_content?`,categories:[`new-media`],example:`/163/today`,parameters:{need_content:`需要获取全文，填写 true/yes 表示需要，默认需要`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`wp.m.163.com/163/html/newsapp/todayFocus/index.html`,`wp.m.163.com/`],target:`/today`}],name:`今日关注`,maintainers:[`nczitzk`],handler:o,url:`wp.m.163.com/163/html/newsapp/todayFocus/index.html`,description:"::: tip\n  参数 **需要获取全文** 设置为 `true` `yes` `t` `y` 等值后，RSS 会携带该新闻条目的对应全文。\n:::"};async function o(a){let o=/t|y/i.test(a.req.param(`need_content`)??`true`),s=`https://gw.m.163.com/nc/api/v1/feed/static/normal-list?start=0&tid=T1573700340788&size=${a.req.query(`limit`)??(o?30:200)}`,c=await n({method:`get`,url:s}),l=c.data.data.items.map(t=>({title:t.title,author:t.source,pubDate:r(e(t.ptime),8),description:`<p>${t.digest}</p><img src="${t.imgsrc}">`,link:t.url||`https://c.m.163.com/news/a/${t.docid}.html`}));return o&&(l=await Promise.all(l.map(e=>t.tryGet(e.link,async()=>{let t=await n({method:`get`,url:e.link}),r=i(t.data);return r(`.bot_word`).remove(),r(`img`).each((e,t)=>{t.attribs.src=t.attribs[`data-src`]??t.attribs.src}),e.description=r(`.content, article`).html(),e})))),{title:`今日关注 - 网易新闻`,link:`https://wp.m.163.com/163/html/newsapp/todayFocus/index.html`,item:l}}export{a as route};