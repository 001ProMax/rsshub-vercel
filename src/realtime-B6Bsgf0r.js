import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{load as r}from"cheerio";const i={path:`/realtime/:category?`,categories:[`traditional-media`],example:`/ebc/realtime/politics`,parameters:{category:`Category from the last segment of the URL of the corresponding site`},features:{requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1,requireConfig:!1},name:`即時新聞`,maintainers:[`quiniapiezoelectricity`],handler:a,description:``,radar:[{source:[`news.ebc.net.tw/realtime/:category`],target:`/:category`}]};async function a(i){let a=i.req.param(`category`)??``,o=await n(`https://news.ebc.net.tw/list/load`,{method:`POST`,headers:{Accept:`*/*`,"Content-Type":`application/x-www-form-urlencoded; charset=UTF-8`,"X-Requested-With":`XMLHttpRequest`},body:new URLSearchParams({list_type:`realtime`,cate_code:a,page:`1`}).toString()}),s=r(o.data),c=s(`div.list > a`).toArray().map(e=>new URL(s(e).attr(`href`)??``,`https://news.ebc.net.tw`).href),l=await Promise.all(c.map(i=>t.tryGet(i,async()=>{let t=await n(i),a=r(t.data),o=a(`[type="application/ld+json"]`).toArray().flatMap(e=>JSON.parse(a(e).text())).find(e=>e[`@type`]===`NewsArticle`);a(`.img_box`).each((e,t)=>{a(t).children(`div.img_caption`).replaceWith(a(`<figcaption>${a(t).children(`div.img_caption`).text()}</figcaption>`)),a(t).children(`div.img`).children().unwrap(),a(t).wrapInner(a(`<figure></figure>`))}),a(`[style="font-size:16px;"]`).each((e,t)=>{a(t).replaceWith(`<small>${a(t).text()}</small>`)});let s=a(`div.article_cover`),c=a(`div.article_content`);return c.find(`.inline_text, .inline_box, .rss_box`).remove(),{title:o.headline,link:i,pubDate:e(o.datePublished),author:o.author.name,description:s.html()+c.html(),category:o.keywords?[o.articleSection,...o.keywords.split(`,`)]:[o.articleSection]}})));return{title:`東森新聞|即時`,link:a?`https://news.ebc.net.tw/realtime/${a}`:`https://news.ebc.net.tw/realtime`,language:`zh-TW`,item:l}}export{i as route};