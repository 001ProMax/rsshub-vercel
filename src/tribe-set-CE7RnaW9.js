import{__dirname as e,init_esm_shims as t}from"./esm-shims-CGUM9TC6.js";import{config as n}from"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as r}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import{cache_default as i}from"./cache-GwMhal7i.js";import{art as a}from"./render-DOz85fGU.js";import{ofetch_default as o}from"./ofetch-ZUQ1sEMc.js";import{ViewType as s}from"./types-A5bA50Mg.js";import c from"node:path";import{load as l}from"cheerio";const u=`https://500px.com.cn`,d={"x-500px-client-info":`eyJhbm9ueW1vdXNJZCI6IiIsImxhdGl0dWRlIjpudWxsLCJsb25naXR1ZGUiOm51bGwsIm1hbnVmYWN0dXJlciI6IiIsInByb3ZpbmNlIjoiIiwiYXJlYSI6IiIsImNpdHkiOiIifQ==`,"X-Tingyun-Id":`Fm3hXcTiLT8;r=${Date.now()%1e8}`},f=e=>i.tryGet(`500px:tribeDetail:${e}`,async()=>{let t=await o(`${u}/community/tribe/tribeDetail`,{headers:{...d},query:{tribeId:e}});return t.data},n.cache.routeExpire,!1),p=(e,t)=>i.tryGet(`500px:tribeSets:${e}`,async()=>{let n=await o(`${u}/community/tribe/getTribeSetsV2`,{headers:{...d},query:{tribeId:e,privacy:1,page:1,size:t,type:`json`}});return n.data},n.cache.routeExpire,!1);t();const m={path:`/tribe/set/:id`,categories:[`picture`],view:s.Pictures,example:`/500px/tribe/set/f5de0b8aa6d54ec486f5e79616418001`,parameters:{id:`部落 ID`},name:`部落影集`,maintainers:[`TonyRL`],handler:h};async function h(t){let n=t.req.param(`id`),i=Number.parseInt(t.req.query(`limit`))||100,{tribe:o}=await f(n),s=await p(n,i),l=s.map(t=>({title:t.title,description:a(c.join(e,`templates/tribeSet-3e687c05.art`),{item:t}),author:t.uploaderInfo.nickName,pubDate:r(t.createdTime,`x`),link:`${u}/community/set/${t.id}/details`}));return{title:o.name,description:`${o.watchword} - ${o.introduce}`,link:`${u}/page/tribe/detail?tribeId=${n}&pagev=set`,image:o.avatar.a1,item:l}}export{m as route};