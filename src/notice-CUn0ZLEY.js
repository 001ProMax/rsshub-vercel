import"./esm-shims-CGUM9TC6.js";import"./config-C9m9eBw5.js";import"./logger-CC3afzWM.js";import{parseDate as e}from"./parse-date-D4osZfpm.js";import"./dist-0j_z2rfc.js";import"./helpers-nWIDkd0K.js";import{cache_default as t}from"./cache-GwMhal7i.js";import"./ofetch-ZUQ1sEMc.js";import{got_default as n}from"./got-CB83B8oA.js";import{timezone as r}from"./timezone-BrNu6iXe.js";const i={0:`全部`,1:`其他`,2:`规则变更`},a={path:`/notice/:type?`,categories:[`programming`],example:`/dangdang/notice/1`,parameters:{type:`公告分类，默认为全部`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`公告`,maintainers:[`353325487`],handler:o,description:`| 类型     | type |
| -------- | ---- |
| 全部      | 0    |
| 其他      | 1    |
| 规则变更   | 2    |`};async function o(a){let o=a.req.param(`type`),s=`https://open.dangdang.com/op-api/developer-platform/document/menu/list?categoryId=3&type=${o>0?i[o]:``}`,c=await n({method:`get`,url:s}),l=c.data.data.documentMenu.map(t=>({title:t.title,description:t.type,documentId:t.documentId,source:`https://open.dangdang.com/op-api/developer-platform/document/info/get?document_id=${t.documentId}`,link:`https://open.dangdang.com/home/notice/message/1/${t.documentId}`,pubDate:r(e(t.modifyTime),8)})),u=await Promise.all(l.map(e=>t.tryGet(e.source,async()=>{let t=await n(e.source);return e.description=t.data.data.documentContentList[0].content,e})));return{title:`当当开放平台 - ${i[o]||i[0]}`,link:`https://open.dangdang.com/home/notice/message/1`,item:u}}export{a as route};